<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sliding Puzzle Game - Free Online Brain Teaser | GamesZone99</title>
    <meta name="description" content="Play the classic sliding puzzle game online for free! Challenge your brain with this addictive tile-sliding puzzle. Perfect for all ages, mobile-friendly with touch controls.">
    <meta name="keywords" content="sliding puzzle, puzzle game, brain teaser, free online game, mobile puzzle, tile puzzle">
    <meta name="author" content="GamesZone99">
    <meta property="og:title" content="Sliding Puzzle Game - Free Online Brain Teaser">
    <meta property="og:description" content="Challenge your brain with this classic sliding puzzle game. Free to play, mobile-friendly!">
    <meta property="og:url" content="https://gameszone99.com/sliding-puzzle.html">
    <meta property="og:type" content="game">
    <link rel="canonical" href="https://gameszone99.com/sliding-puzzle.html">
    
    <style>
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #b8b8b8;
            --accent-color: #00d4ff;
            --success-color: #00ff88;
            --danger-color: #ff4757;
            --warning-color: #ffa502;
            --dark-gradient: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            --game-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: var(--dark-gradient);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Top Ad Container */
        .ad-container-top {
            width: 100%;
            min-height: 90px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--card-border);
        }

        .ad-placeholder {
            color: var(--text-secondary);
            font-size: 14px;
            padding: 20px;
            border: 2px dashed var(--card-border);
            border-radius: 8px;
            background: var(--card-bg);
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--card-border);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .game-title {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-color);
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-button {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-primary);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 0.9rem;
        }

        .nav-button:hover {
            background: var(--accent-color);
            color: #000;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
        }

        /* Main Game Container */
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .game-section {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .game-section.loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
            animation: loading 2s infinite;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stats-section {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stat-box {
            background: var(--bg-secondary);
            border: 1px solid var(--card-border);
            border-radius: 15px;
            padding: 1rem;
            text-align: center;
            min-width: 80px;
            backdrop-filter: blur(10px);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            color: var(--accent-color);
            font-size: 1.5rem;
            font-weight: bold;
        }

        .game-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .control-button {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-primary);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 0.9rem;
        }

        .control-button:hover {
            background: var(--accent-color);
            color: #000;
            transform: translateY(-2px);
        }

        .control-button.new-game {
            background: var(--success-color);
            color: #000;
        }

        .control-button.new-game:hover {
            background: #00cc77;
        }

        /* Puzzle Grid */
        .puzzle-container {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
        }

        .puzzle-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            width: 320px;
            height: 320px;
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 15px;
            border: 1px solid var(--card-border);
        }

        .puzzle-tile {
            background: var(--game-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .puzzle-tile:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .puzzle-tile.empty {
            background: transparent;
            cursor: default;
            border: 1px dashed var(--card-border);
        }

        .puzzle-tile.empty:hover {
            transform: none;
            box-shadow: none;
        }

        .puzzle-tile.hint {
            background: var(--warning-color) !important;
            animation: pulse 1.5s ease-in-out;
        }

        /* Game Status */
        .game-status {
            text-align: center;
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 15px;
            font-weight: bold;
            display: none;
        }

        .game-status.win {
            background: linear-gradient(135deg, var(--success-color), #00cc77);
            color: #000;
            display: block;
            animation: celebration 0.6s ease-in-out;
        }

        /* Instructions */
        .instructions {
            background: var(--bg-secondary);
            border: 1px solid var(--card-border);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            text-align: center;
        }

        .instructions h3 {
            color: var(--accent-color);
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }

        .instructions p {
            color: var(--text-secondary);
            margin-bottom: 0.8rem;
            line-height: 1.6;
        }

        .instructions strong {
            color: var(--text-primary);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }

        .modal h2 {
            color: var(--accent-color);
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .modal-stats {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 15px;
        }

        .modal-stats p {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .modal-stats strong {
            color: var(--text-primary);
        }

        /* Bottom Ad Container */
        .ad-container-bottom {
            width: 100%;
            min-height: 90px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid var(--card-border);
            margin-top: 2rem;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes celebration {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .game-title {
                font-size: 1.8rem;
            }
            
            .game-container {
                padding: 1rem;
            }
            
            .game-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .puzzle-grid {
                width: 280px;
                height: 280px;
            }
            
            .puzzle-tile {
                font-size: 1.4rem;
            }
            
            .stat-box {
                min-width: 70px;
                padding: 0.8rem;
            }
            
            .stat-value {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 480px) {
            .nav-buttons {
                justify-content: center;
            }
            
            .nav-button {
                padding: 0.6rem 1.2rem;
                font-size: 0.8rem;
            }
            
            .puzzle-grid {
                width: 260px;
                height: 260px;
                gap: 6px;
            }
            
            .control-button {
                padding: 0.6rem 1.2rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Top Ad Container -->
    <div class="ad-container-top">
        <div class="ad-placeholder">728x90 Header Advertisement</div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="game-title">üß© Sliding Puzzle</h1>
            <nav class="nav-buttons">
                <a href="/" class="nav-button">üè† Home</a>
                <a href="/games" class="nav-button">üéÆ More Games</a>
                <a href="#" class="nav-button" onclick="showInstructions()">‚ùì How to Play</a>
                <a href="#" class="nav-button" onclick="toggleFullscreen()">üì± Fullscreen</a>
            </nav>
        </div>
    </header>

    <!-- Main Game Container -->
    <div class="game-container">
        <!-- Game Section -->
        <main class="game-section loading">
            <div class="game-header">
                <div class="stats-section">
                    <div class="stat-box">
                        <div class="stat-label">Moves</div>
                        <div class="stat-value" id="moveCount">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Time</div>
                        <div class="stat-value" id="timeDisplay">00:00</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Best</div>
                        <div class="stat-value" id="bestTime">--:--</div>
                    </div>
                </div>
                
                <div class="game-controls">
                    <button class="control-button new-game" onclick="startGame()">üÜï New Game</button>
                    <button class="control-button" onclick="shuffleBoard()">üîÄ Shuffle</button>
                    <button class="control-button" onclick="giveHint()">üí° Hint</button>
                </div>
            </div>

            <div class="game-status" id="gameStatus"></div>

            <!-- Puzzle Container -->
            <div class="puzzle-container">
                <div class="puzzle-grid" id="puzzleGrid"></div>
            </div>

            <!-- Instructions -->
            <div class="instructions">
                <h3>How to Play</h3>
                <p><strong>üéØ Objective:</strong> Arrange the numbered tiles in order from 1-15</p>
                <p><strong>üïπÔ∏è Controls:</strong> Click or tap tiles next to the empty space to slide them</p>
                <p><strong>üèÜ Goal:</strong> Complete the puzzle in the fewest moves and fastest time!</p>
                <p><strong>üí° Tip:</strong> Use the hint button if you get stuck</p>
            </div>
        </main>
    </div>

    <!-- Win Modal -->
    <div class="modal" id="winModal">
        <div class="modal-content">
            <h2>üéâ Congratulations!</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1rem;">You solved the puzzle!</p>
            <div class="modal-stats">
                <p><strong>Moves:</strong> <span id="finalMoves">0</span></p>
                <p><strong>Time:</strong> <span id="finalTime">00:00</span></p>
                <p><strong>New Record:</strong> <span id="newRecord">No</span></p>
            </div>
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <button class="control-button new-game" onclick="closeModal()">Play Again</button>
                <button class="control-button" onclick="shareScore()">Share Score</button>
            </div>
        </div>
    </div>

    <!-- Bottom Ad Container -->
    <div class="ad-container-bottom">
        <div class="ad-placeholder">728x90 Footer Advertisement</div>
    </div>

    <script>
        class SlidingPuzzle {
            constructor() {
                this.size = 4;
                this.tiles = [];
                this.emptyPos = { row: 3, col: 3 };
                this.moves = 0;
                this.startTime = null;
                this.gameTime = 0;
                this.gameActive = false;
                this.timer = null;
                
                this.initializeGame();
                this.loadBestTime();
                this.bindEvents();
                
                // Remove loading state after initialization
                setTimeout(() => {
                    document.querySelector('.game-section').classList.remove('loading');
                }, 1000);
            }

            initializeGame() {
                this.createInitialBoard();
                this.renderBoard();
                this.updateStats();
            }

            createInitialBoard() {
                this.tiles = [];
                let num = 1;
                
                for (let row = 0; row < this.size; row++) {
                    this.tiles[row] = [];
                    for (let col = 0; col < this.size; col++) {
                        if (row === this.size - 1 && col === this.size - 1) {
                            this.tiles[row][col] = 0; // Empty space
                        } else {
                            this.tiles[row][col] = num++;
                        }
                    }
                }
            }

            renderBoard() {
                const grid = document.getElementById('puzzleGrid');
                grid.innerHTML = '';

                for (let row = 0; row < this.size; row++) {
                    for (let col = 0; col < this.size; col++) {
                        const tile = document.createElement('div');
                        tile.className = 'puzzle-tile';
                        tile.dataset.row = row;
                        tile.dataset.col = col;

                        if (this.tiles[row][col] === 0) {
                            tile.className += ' empty';
                        } else {
                            tile.textContent = this.tiles[row][col];
                            tile.addEventListener('click', () => this.handleTileClick(row, col));
                        }

                        grid.appendChild(tile);
                    }
                }
            }

            handleTileClick(row, col) {
                if (!this.gameActive) return;

                if (this.canMove(row, col)) {
                    this.moveTile(row, col);
                    this.moves++;
                    this.updateStats();
                    
                    if (this.checkWin()) {
                        this.endGame(true);
                    }
                }
            }

            canMove(row, col) {
                const rowDiff = Math.abs(row - this.emptyPos.row);
                const colDiff = Math.abs(col - this.emptyPos.col);
                return (rowDiff === 1 && colDiff === 0) || (rowDiff === 0 && colDiff === 1);
            }

            moveTile(row, col) {
                // Swap tile with empty space
                this.tiles[this.emptyPos.row][this.emptyPos.col] = this.tiles[row][col];
                this.tiles[row][col] = 0;
                this.emptyPos = { row, col };
                this.renderBoard();
            }

            shuffleBoard() {
                if (!this.gameActive) return;
                
                // Perform random valid moves to ensure solvable puzzle
                const moves = 1000;
                for (let i = 0; i < moves; i++) {
                    const directions = this.getValidMoves();
                    const randomDir = directions[Math.floor(Math.random() * directions.length)];
                    this.moveTile(randomDir.row, randomDir.col);
                }
                this.moves = 0;
                this.updateStats();
            }

            getValidMoves() {
                const moves = [];
                const { row, col } = this.emptyPos;
                
                // Check all four directions
                const directions = [
                    { row: row - 1, col }, // Up
                    { row: row + 1, col }, // Down
                    { row, col: col - 1 }, // Left
                    { row, col: col + 1 }  // Right
                ];

                directions.forEach(dir => {
                    if (dir.row >= 0 && dir.row < this.size && 
                        dir.col >= 0 && dir.col < this.size) {
                        moves.push(dir);
                    }
                });

                return moves;
            }

            startTimer() {
                this.timer = setInterval(() => {
                    if (this.gameActive) {
                        this.gameTime = Math.floor((Date.now() - this.startTime) / 1000);
                        this.updateTimeDisplay();
                    }
                }, 1000);
            }

            updateTimeDisplay() {
                const minutes = Math.floor(this.gameTime / 60);
                const seconds = this.gameTime % 60;
                document.getElementById('timeDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }

            updateStats() {
                document.getElementById('moveCount').textContent = this.moves;
                if (this.gameActive) {
                    this.updateTimeDisplay();
                }
            }

            checkWin() {
                let expected = 1;
                for (let row = 0; row < this.size; row++) {
                    for (let col = 0; col < this.size; col++) {
                        if (row === this.size - 1 && col === this.size - 1) {
                            return this.tiles[row][col] === 0;
                        }
                        if (this.tiles[row][col] !== expected) {
                            return false;
                        }
                        expected++;
                    }
                }
                return true;
            }

            endGame(won) {
                this.gameActive = false;
                clearInterval(this.timer);

                if (won) {
                    const isNewRecord = this.checkNewRecord();
                    this.showWinModal(isNewRecord);
                    
                    document.getElementById('gameStatus').className = 'game-status win';
                    document.getElementById('gameStatus').textContent = 
                        `üéâ Puzzle Solved in ${this.moves} moves and ${this.formatTime(this.gameTime)}!`;
                    document.getElementById('gameStatus').style.display = 'block';
                }
            }

            checkNewRecord() {
                const bestTime = localStorage.getItem('slidingPuzzleBest');
                if (!bestTime || this.gameTime < parseInt(bestTime)) {
                    localStorage.setItem('slidingPuzzleBest', this.gameTime.toString());
                    this.loadBestTime();
                    return true;
                }
                return false;
            }

            loadBestTime() {
                const bestTime = localStorage.getItem('slidingPuzzleBest');
                if (bestTime) {
                    document.getElementById('bestTime').textContent = this.formatTime(parseInt(bestTime));
                }
            }

            formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }

            showWinModal(isNewRecord) {
                document.getElementById('finalMoves').textContent = this.moves;
                document.getElementById('finalTime').textContent = this.formatTime(this.gameTime);
                document.getElementById('newRecord').textContent = isNewRecord ? 'Yes! üéâ' : 'No';
                document.getElementById('winModal').style.display = 'block';
                
                // Add celebration animation
                document.querySelector('.puzzle-container').style.animation = 'celebration 0.6s ease-in-out';
                setTimeout(() => {
                    document.querySelector('.puzzle-container').style.animation = '';
                }, 600);
            }

            bindEvents() {
                // Keyboard controls
                document.addEventListener('keydown', (e) => {
                    if (!this.gameActive) return;
                    
                    const { row, col } = this.emptyPos;
                    let targetRow = row, targetCol = col;
                    
                    switch (e.key) {
                        case 'ArrowUp':
                            targetRow = row + 1;
                            break;
                        case 'ArrowDown':
                            targetRow = row - 1;
                            break;
                        case 'ArrowLeft':
                            targetCol = col + 1;
                            break;
                        case 'ArrowRight':
                            targetCol = col - 1;
                            break;
                        default:
                            return;
                    }
                    
                    if (targetRow >= 0 && targetRow < this.size && 
                        targetCol >= 0 && targetCol < this.size) {
                        this.handleTileClick(targetRow, targetCol);
                    }
                });
            }
        }

        // Initialize game
        let game;
        document.addEventListener('DOMContentLoaded', () => {
            game = new SlidingPuzzle();
        });

        // Game functions
        function startGame() {
            if (game.gameActive) {
                // Restart game
                clearInterval(game.timer);
                game.gameActive = false;
                game.moves = 0;
                game.gameTime = 0;
                game.createInitialBoard();
                game.renderBoard();
                game.updateStats();
                document.getElementById('gameStatus').style.display = 'none';
            }
            
            // Start new game
            game.shuffleBoard();
            game.gameActive = true;
            game.startTime = Date.now();
            game.moves = 0;
            game.startTimer();
            game.updateStats();
        }

        function shuffleBoard() {
            game.shuffleBoard();
        }

        function giveHint() {
            if (!game.gameActive) return;
            
            // Find the first misplaced tile and highlight it
            for (let row = 0; row < game.size; row++) {
                for (let col = 0; col < game.size; col++) {
                    const expectedValue = row * game.size + col + 1;
                    if (row === game.size - 1 && col === game.size - 1) continue;
                    
                    if (game.tiles[row][col] !== expectedValue) {
                        const tileElement = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                        tileElement.classList.add('hint');
                        
                        setTimeout(() => {
                            tileElement.classList.remove('hint');
                        }, 1500);
                        return;
                    }
                }
            }
        }

        function showInstructions() {
            document.querySelector('.instructions').scrollIntoView({ behavior: 'smooth' });
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Modal functions
        function closeModal() {
            document.getElementById('winModal').style.display = 'none';
            startGame();
        }

        function shareScore() {
            const moves = document.getElementById('finalMoves').textContent;
            const time = document.getElementById('finalTime').textContent;
            const text = `I just solved the Sliding Puzzle in ${moves} moves and ${time}! Can you beat my score? Play at gameszone99.com`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Sliding Puzzle Score',
                    text: text,
                    url: 'https://gameszone99.com/sliding-puzzle.html'
                });
            } else {
                navigator.clipboard.writeText(text).then(() => {
                    alert('Score copied to clipboard!');
                });
            }
        }

        // Touch event handling for mobile
        let touchStartX = 0;
        let touchStartY = 0;

        document.getElementById('puzzleGrid').addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });

        document.getElementById('puzzleGrid').addEventListener('touchend', (e) => {
            if (!game.gameActive) return;
            
            const touchEndX = e.changedTouches[0].clientX;
const touchEndY = e.changedTouches[0].clientY;
           const deltaX = touchEndX - touchStartX;
           const deltaY = touchEndY - touchStartY;
           
           // Minimum swipe distance
           const minSwipeDistance = 30;
           
           if (Math.abs(deltaX) > minSwipeDistance || Math.abs(deltaY) > minSwipeDistance) {
               const { row, col } = game.emptyPos;
               let targetRow = row, targetCol = col;
               
               if (Math.abs(deltaX) > Math.abs(deltaY)) {
                   // Horizontal swipe
                   if (deltaX > 0) {
                       targetCol = col - 1; // Swipe right, move tile left
                   } else {
                       targetCol = col + 1; // Swipe left, move tile right
                   }
               } else {
                   // Vertical swipe
                   if (deltaY > 0) {
                       targetRow = row - 1; // Swipe down, move tile up
                   } else {
                       targetRow = row + 1; // Swipe up, move tile down
                   }
               }
               
               if (targetRow >= 0 && targetRow < game.size && 
                   targetCol >= 0 && targetCol < game.size) {
                   game.handleTileClick(targetRow, targetCol);
               }
           }
       });

       // Prevent default touch behaviors on game area
       document.getElementById('puzzleGrid').addEventListener('touchmove', (e) => {
           e.preventDefault();
       }, { passive: false });

       // Add visual feedback for mobile touches
       document.getElementById('puzzleGrid').addEventListener('touchstart', (e) => {
           const tile = e.target.closest('.puzzle-tile');
           if (tile && !tile.classList.contains('empty')) {
               tile.style.transform = 'scale(0.95)';
           }
       });

       document.getElementById('puzzleGrid').addEventListener('touchend', (e) => {
           const tile = e.target.closest('.puzzle-tile');
           if (tile && !tile.classList.contains('empty')) {
               tile.style.transform = '';
           }
       });

       // Service Worker for offline functionality (optional)
       if ('serviceWorker' in navigator) {
           window.addEventListener('load', () => {
               navigator.serviceWorker.register('/sw.js').then(() => {
                   console.log('SW registered');
               }).catch(() => {
                   console.log('SW registration failed');
               });
           });
       }

       // Analytics tracking (placeholder)
       function trackEvent(action, category = 'Game') {
           // Replace with your analytics code
           if (typeof gtag !== 'undefined') {
               gtag('event', action, {
                   event_category: category,
                   event_label: 'Sliding Puzzle'
               });
           }
       }

       // Track game events
       document.addEventListener('DOMContentLoaded', () => {
           trackEvent('game_loaded');
       });

       // Override game functions to add tracking
       const originalStartGame = startGame;
       startGame = function() {
           trackEvent('game_started');
           originalStartGame();
       };

       const originalEndGame = game.endGame;
       game.endGame = function(won) {
           if (won) {
               trackEvent('game_completed');
           }
           originalEndGame.call(this, won);
       };
   </script>

   <!-- Schema.org structured data for SEO -->
   <script type="application/ld+json">
   {
       "@context": "https://schema.org",
       "@type": "Game",
       "name": "Sliding Puzzle Game",
       "description": "Challenge your brain with this classic sliding puzzle game. Arrange numbered tiles in order by sliding them into the empty space.",
       "url": "https://gameszone99.com/sliding-puzzle.html",
       "genre": "Puzzle",
       "playMode": "SinglePlayer",
       "accessMode": "visual",
       "accessibilityFeature": ["keyboardNavigation", "touchNavigation"],
       "browserRequirements": "HTML5, JavaScript enabled",
       "operatingSystem": "Any",
       "applicationCategory": "Game",
       "offers": {
           "@type": "Offer",
           "price": "0",
           "priceCurrency": "USD"
       },
       "publisher": {
           "@type": "Organization",
           "name": "GamesZone99",
           "url": "https://gameszone99.com"
       }
   }
   </script>
</body>
</html>