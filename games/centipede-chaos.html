<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centipede Chaos - Classic Arcade Shooter | Gameszone99.com</title>
    <meta name="description" content="Play Centipede Chaos - Classic arcade shooter with modern graphics! Blast centipedes, avoid obstacles, and beat your high score. Free HTML5 game with touch controls!">
    <meta name="keywords" content="centipede game, arcade shooter, html5 game, mobile game, browser game, classic arcade, free games, centipede chaos">
    <meta name="author" content="Gameszone99">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="game">
    <meta property="og:url" content="https://gameszone99.com/centipede-chaos.html">
    <meta property="og:title" content="Centipede Chaos - Classic Arcade Shooter">
    <meta property="og:description" content="Classic arcade shooter with modern graphics! Blast centipedes and beat your high score!">
    <meta property="og:image" content="https://gameszone99.com/assets/centipede-chaos-preview.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://gameszone99.com/centipede-chaos.html">
    <meta property="twitter:title" content="Centipede Chaos - Classic Arcade Shooter">
    <meta property="twitter:description" content="Classic arcade shooter with modern graphics! Play for free!">
    
    <link rel="canonical" href="https://gameszone99.com/centipede-chaos.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Replace the existing color variables and body styles with these */

:root {
    --primary-color: #6c5ce7;
    --secondary-color: #a29bfe;
    --accent-color: #00d4ff;
    --success-color: #00b894;
    --warning-color: #fdcb6e;
    --danger-color: #e17055;
    --dark-bg: #0f0f23;
    --light-bg: #1a1a2e;
    --text-primary: #ffffff;
    --text-secondary: #b8c1ec;
    --card-bg: rgba(255, 255, 255, 0.1);
    --card-border: rgba(255, 255, 255, 0.2);
    --shadow-card: 0 8px 32px rgba(108, 92, 231, 0.3);
    --primary-gradient: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
    --secondary-gradient: linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%);
}

body {
    font-family: "Inter", sans-serif;
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
    min-height: 100vh;
    color: var(--text-primary);
    overflow-x: hidden;
    margin: 0;
    padding: 0;
}

/* Fix game title gradient to match other games */
.game-title {
    font-family: "Orbitron", monospace;
    font-size: 1.8rem;
    font-weight: 900;
    background: linear-gradient(135deg, var(--accent-color) 0%, var(--primary-color) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* Fix instruction text colors */
.instructions {
    color: var(--text-secondary);
    line-height: 1.5;
    font-size: 0.9rem;
}

.instructions strong {
    color: var(--text-primary);
}

/* Fix sidebar title color */
.sidebar-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.8rem;
    color: var(--accent-color);
}

/* Fix stat label colors */
.stat-label {
    font-size: 0.7rem;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.2rem;
}

.stat-value {
    font-family: "Orbitron", monospace;
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--accent-color);
}

/* Fix modal text colors */
.modal-title {
    font-family: "Orbitron", monospace;
    font-size: 1.5rem;
    color: var(--accent-color);
    margin-bottom: 1rem;
}

.modal-stats {
    margin: 1.5rem 0;
    color: var(--text-primary);
}

.modal-stat {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
    color: var(--text-secondary);
}

.modal-stat span:last-child {
    color: var(--accent-color);
    font-weight: 600;
}

/* Fix start overlay text */
.start-overlay h2 {
    font-family: "Orbitron", monospace;
    color: var(--accent-color);
    margin-bottom: 1rem;
}

.start-overlay p {
    color: var(--text-secondary);
    margin-bottom: 1rem;
    text-align: center;
    max-width: 300px;
}

/* Fix ad placeholder colors to match */
.ad-placeholder {
    background: linear-gradient(45deg, #0f0f23, #1a1a2e);
    color: var(--text-secondary);
    padding: 20px;
    border: 2px dashed var(--card-border);
    border-radius: 8px;
    font-size: 14px;
    display: inline-block;
}

/* Fix leaderboard section colors */
#leaderboard {
    color: var(--text-secondary);
}

/* Fix canvas background to match dark theme */
#gameCanvas {
    background: linear-gradient(135deg, #0f0f23 0%, #16213e 100%);
    border: 1px solid var(--card-border);
    border-radius: 8px;
    display: block;
    margin: 0 auto;
    max-width: 100%;
    height: auto;
}

/* Ensure all text is properly colored */
h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary);
}

p {
    color: var(--text-secondary);
}

/* Fix any remaining white text issues */
.header {
    background: rgba(15, 15, 35, 0.9);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--card-border);
    padding: 1rem 0;
}

.ad-container-top, .ad-container-bottom {
    background: rgba(15, 15, 35, 0.8);
    border-bottom: 1px solid var(--card-border);
}

.ad-container-bottom {
    border-top: 1px solid var(--card-border);
    border-bottom: none;
}

        .ad-placeholder {
            background: linear-gradient(45deg, #333, #555);
            color: #999;
            padding: 20px;
            border: 2px dashed #666;
            border-radius: 8px;
            font-size: 14px;
            display: inline-block;
        }

        /* Header Styles */
        .header {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
            padding: 1rem 0;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .game-title {
            font-family: "Orbitron", monospace;
            font-size: 1.8rem;
            font-weight: 900;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-buttons {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 8px 16px;
            background: var(--secondary-gradient);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-card);
        }

        /* Replace the existing styles with these corrected ones */

/* Main Game Container - Fix layout structure */
.game-container {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 1rem;
    display: flex;
    gap: 2rem;
}

.game-section {
    flex: 2;
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 12px;
    padding: 1.2rem;
    backdrop-filter: blur(10px);
    transition: all 0.5s ease;
    opacity: 0;
}

/* Fix sidebar to match other games */
.sidebar {
    flex: 1;
    min-width: 280px;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.sidebar-section {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 12px;
    padding: 1.2rem;
    backdrop-filter: blur(10px);
}

.sidebar-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.8rem;
    color: var(--accent-color);
}

.instructions {
    color: var(--text-secondary);
    line-height: 1.5;
    font-size: 0.9rem;
}

.instructions ul {
    margin: 0.8rem 0;
    padding-left: 1.2rem;
}

.instructions li {
    margin-bottom: 0.4rem;
}

/* Fix game header layout */
.game-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.2rem;
    flex-wrap: wrap;
    gap: 1rem;
}

/* Fix stats section */
.stats-section {
    display: flex;
    gap: 0.8rem;
    flex-wrap: wrap;
}

.stat-box {
    text-align: center;
    background: rgba(255, 255, 255, 0.05);
    padding: 0.8rem;
    border-radius: 8px;
    min-width: 70px;
}

.stat-label {
    font-size: 0.7rem;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.2rem;
}

.stat-value {
    font-family: "Orbitron", monospace;
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--accent-color);
}

/* Fix control buttons */
.game-controls {
    display: flex;
    gap: 0.6rem;
    flex-wrap: wrap;
}

.control-button {
    padding: 8px 14px;
    background: var(--secondary-gradient);
    border: none;
    border-radius: 8px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.8rem;
}

/* Fix canvas container */
.game-canvas-container {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 12px;
    padding: 1rem;
    backdrop-filter: blur(10px);
    position: relative;
    text-align: center;
}

#gameCanvas {
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
    border: 1px solid var(--card-border);
    border-radius: 8px;
    display: block;
    margin: 0 auto;
    max-width: 100%;
    height: auto;
}

/* Fix mobile controls */
.mobile-controls {
    display: none;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.8rem;
    margin-top: 1.2rem;
    max-width: 220px;
    margin-left: auto;
    margin-right: auto;
}

.mobile-control {
    aspect-ratio: 1;
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    user-select: none;
}

.mobile-control:hover, .mobile-control:active {
    background: var(--accent-color);
    transform: translateY(-2px);
}

.mobile-control.empty {
    visibility: hidden;
}

/* Fix loading animation */
.loading {
    opacity: 0;
    animation: fadeIn 0.6s ease forwards;
}

@keyframes fadeIn {
    to { opacity: 1; }
}

/* Fix modal buttons */
.modal-button {
    padding: 12px 24px;
    background: var(--secondary-gradient);
    border: none;
    border-radius: 10px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1rem;
}

.modal-button:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-card);
}

.modal-button.primary {
    background: var(--accent-color);
    color: #000;
}

/* Fix bottom ad container */
.ad-container-bottom {
    width: 100%;
    min-height: 90px;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    border-top: 1px solid var(--card-border);
    margin-top: 2rem;
}

/* Fix responsive design to match other games */
@media (max-width: 768px) {
    .game-container {
        flex-direction: column;
        padding: 1rem;
    }
    
    .header-content {
        flex-direction: column;
        text-align: center;
    }
    
    .game-title {
        font-size: 1.5rem;
    }
    
    .nav-buttons {
        justify-content: center;
    }
    
    .game-header {
        flex-direction: column;
        align-items: stretch;
        text-align: center;
    }
    
    .stats-section {
        justify-content: center;
    }
    
    .game-controls {
        justify-content: center;
    }
    
    .mobile-controls {
        display: grid;
    }
    
    .sidebar {
        order: -1;
    }
    
    .ad-placeholder {
        width: 320px;
        height: 50px;
        font-size: 12px;
    }
}

@media (max-width: 480px) {
    .game-container {
        padding: 0.5rem;
    }
    
    .stats-section {
        grid-template-columns: repeat(2, 1fr);
        display: grid;
    }
    
    .game-controls {
        flex-direction: column;
        align-items: center;
    }
    
    .control-button {
        width: 100%;
        max-width: 200px;
    }

    #gameCanvas {
        max-width: 280px;
        height: 280px;
    }
}

        /* Start Game Overlay */
        .start-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 15px;
            z-index: 10;
        }

        .start-button {
            padding: 15px 30px;
            background: var(--primary-gradient);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-card);
        }

        /* Mobile Controls */
        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
            max-width: 250px;
            margin-left: auto;
            margin-right: auto;
        }

        .mobile-control {
            aspect-ratio: 1;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            user-select: none;
        }

        .mobile-control:hover, .mobile-control:active {
            background: var(--primary-color);
            transform: scale(0.95);
        }

        .mobile-control.empty {
            visibility: hidden;
        }

        /* Game Over Modal */
        .game-over-modal {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 15px;
            z-index: 20;
        }

        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            backdrop-filter: blur(20px);
            max-width: 300px;
            width: 90%;
        }

        .modal-title {
            font-family: "Orbitron", monospace;
            font-size: 1.5rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .modal-stats {
            margin: 1.5rem 0;
        }

        .modal-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .modal-button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-button.primary {
            background: var(--primary-gradient);
            color: white;
        }

        .modal-button.secondary {
            background: var(--secondary-gradient);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                margin: 1rem auto;
            }

            .mobile-controls {
                display: grid;
            }

            .game-header {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }

            .stats-section, .game-controls {
                justify-content: center;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .nav-buttons {
                justify-content: center;
            }

            .game-title {
                font-size: 1.5rem;
            }

            .sidebar {
                order: -1;
            }

            #gameCanvas {
                width: 100%;
                max-width: 400px;
            }
        }

        @media (max-width: 480px) {
            .game-container {
                padding: 0 0.5rem;
            }

            .game-section, .sidebar-section {
                padding: 1rem;
            }

            .game-title {
                font-size: 1.3rem;
            }

            .nav-button {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .stat-box {
                min-width: 70px;
                padding: 0.6rem;
            }

            .stat-value {
                font-size: 1rem;
            }

            .control-button {
                padding: 6px 12px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <!-- Top Ad Container -->
    <div class="ad-container-top">
        <div class="ad-placeholder">728x90 Header Advertisement</div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="game-title">🐛 Centipede Chaos</h1>
            <nav class="nav-buttons">
                <a href="/" class="nav-button">🏠 Home</a>
                <a href="/games" class="nav-button">🎮 More Games</a>
                <a href="#" class="nav-button" onclick="showInstructions()">❓ How to Play</a>
                <a href="#" class="nav-button" onclick="toggleFullscreen()">📱 Fullscreen</a>
            </nav>
        </div>
    </header>

    <!-- Main Game Container -->
    <div class="game-container">
        <!-- Game Section -->
        <main class="game-section loading">
            <div class="game-header">
                <div class="stats-section">
                    <div class="stat-box">
                        <div class="stat-label">Score</div>
                        <div class="stat-value" id="currentScore">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Best</div>
                        <div class="stat-value" id="bestScore">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Level</div>
                        <div class="stat-value" id="gameLevel">1</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Lives</div>
                        <div class="stat-value" id="playerLives">3</div>
                    </div>
                </div>
                
                <div class="game-controls">
                    <button class="control-button new-game" onclick="resetGame()">🆕 New Game</button>
                    <button class="control-button pause" onclick="togglePause()" id="pauseButton">⏸️ Pause</button>
                    <button class="control-button" onclick="showLeaderboard()">🏆 Scores</button>
                </div>
            </div>

            <!-- Game Canvas -->
            <div class="game-canvas-container">
                <canvas id="gameCanvas" width="600" height="400"></canvas>
                
                <!-- Start Game Overlay -->
                <div class="start-overlay" id="startOverlay">
                    <h2 style="font-family: Orbitron; color: #fd79a8; margin-bottom: 1rem;">🐛 Centipede Chaos</h2>
                    <p style="margin-bottom: 1rem; text-align: center; max-width: 300px;">
                        Classic arcade shooter! Move your ship with arrow keys or touch controls, and blast the centipede to pieces!
                    </p>
                    <button class="start-button" onclick="startGame()">🚀 Start Game</button>
                </div>

                <!-- Game Over Modal -->
                <div class="game-over-modal" id="gameOverModal">
                    <div class="modal-content">
                        <h2 class="modal-title">🎯 Game Over!</h2>
                        <div class="modal-stats">
                            <div class="modal-stat">
                                <span>Final Score:</span>
                                <span id="finalScore">0</span>
                            </div>
                            <div class="modal-stat">
                                <span>Level Reached:</span>
                                <span id="finalLevel">1</span>
                            </div>
                            <div class="modal-stat">
                                <span>Best Score:</span>
                                <span id="modalBestScore">0</span>
                            </div>
                        </div>
                        <div class="modal-buttons">
                            <button class="modal-button primary" onclick="startNewGame()">🔄 Play Again</button>
                            <button class="modal-button secondary" onclick="shareScore()">📱 Share</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mobile Controls -->
            <div class="mobile-controls">
                <div class="mobile-control empty"></div>
                <div class="mobile-control" onmousedown="startMove('up')" onmouseup="stopMove()" ontouchstart="startMove('up')" ontouchend="stopMove()">⬆️</div>
                <div class="mobile-control empty"></div>
                <div class="mobile-control" onmousedown="startMove('left')" onmouseup="stopMove()" ontouchstart="startMove('left')" ontouchend="stopMove()">⬅️</div>
                <div class="mobile-control" onclick="fireShot()">🔥</div>
                <div class="mobile-control" onmousedown="startMove('right')" onmouseup="stopMove()" ontouchstart="startMove('right')" ontouchend="stopMove()">➡️</div>
                <div class="mobile-control empty"></div>
                <div class="mobile-control" onmousedown="startMove('down')" onmouseup="stopMove()" ontouchstart="startMove('down')" ontouchend="stopMove()">⬇️</div>
                <div class="mobile-control empty"></div>
            </div>
        </main>

        <!-- Sidebar -->
        <aside class="sidebar loading">
            <div class="sidebar-section">
                <h3 class="sidebar-title">🎯 How to Play</h3>
                <div class="instructions">
                    <p><strong>Classic arcade shooter with modern graphics!</strong></p>
                    <ul>
                        <li>Use arrow keys or touch controls to move your ship</li>
                        <li>Press spacebar or tap fire button to shoot</li>
                        <li>Destroy centipede segments to score points</li>
                        <li>Avoid touching the centipede or other enemies</li>
                        <li>Clear the screen to advance to the next level</li>
                        <li>Collect power-ups for special abilities</li>
                    </ul>
                    <p style="margin-top: 1rem;"><strong>Pro Tips:</strong> Target the head of the centipede for bonus points! Create barriers by shooting mushrooms strategically.</p>
                </div>
            </div>

            <div class="sidebar-section" style="min-height: 250px; display: flex; align-items: center; justify-content: center;">
                <div style="width: 250px; height: 250px; background: linear-gradient(45deg, #333, #555); border: 2px dashed #666; display: flex; align-items: center; justify-content: center; color: #999; font-size: 14px; border-radius: 8px; text-align: center;">
                    250x250<br>Sidebar Ad
                </div>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-title">🏆 Leaderboard</h3>
                <div id="leaderboard">
                    <div style="text-align: center; color: #999; padding: 2rem;">
                        Start playing to see scores!
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Bottom Ad Container -->
    <div class="ad-container-bottom">
        <div class="ad-placeholder">728x90 Footer Advertisement</div>
    </div>

    <script>
        // Game Configuration
        const CONFIG = {
            CANVAS_WIDTH: 600,
            CANVAS_HEIGHT: 400,
            PLAYER_SPEED: 4,
            BULLET_SPEED: 8,
            CENTIPEDE_SPEED: 2,
            GRID_SIZE: 20,
            MUSHROOM_COUNT: 30
        };

        // Game State
        const game = {
            canvas: null,
            ctx: null,
            score: 0,
            bestScore: parseInt(localStorage.getItem("centipede-chaos-best") || "0"),
            level: 1,
            lives: 3,
            gameRunning: false,
            gamePaused: false,
            gameOver: false,
            keys: {},
            moveDirection: null,
            moveInterval: null,
            
            // Game objects
            player: { x: 300, y: 360, width: 20, height: 20 },
            bullets: [],
            centipede: [],
            mushrooms: [],
            enemies: [],
            powerUps: []
        };

        // Initialize game
        function initGame() {
            game.canvas = document.getElementById("gameCanvas");
            game.ctx = game.canvas.getContext("2d");
            
            // Set canvas size
            game.canvas.width = CONFIG.CANVAS_WIDTH;
            game.canvas.height = CONFIG.CANVAS_HEIGHT;
            
            // Load best score
            document.getElementById("bestScore").textContent = game.bestScore;
            
            // Event listeners
            document.addEventListener("keydown", handleKeyDown);
            document.addEventListener("keyup", handleKeyUp);
            
            // Touch controls
            setupTouchControls();
            
            // Initialize game objects
            createMushrooms();
            updateDisplay();
            
            // Animate elements
            setTimeout(() => {
                document.querySelectorAll(".loading").forEach(el => {
                    el.style.opacity = "1";
                });
            }, 100);
        }

        // Start Game
        function startGame() {
            document.getElementById("startOverlay").style.display = "none";
            resetGame();
        }

        // Reset/New Game
        function resetGame() {
            game.score = 0;
            game.level = 1;
            game.lives = 3;
            game.gameRunning = true;
            game.gamePaused = false;
            game.gameOver = false;
            
            // Reset player position
            game.player.x = CONFIG.CANVAS_WIDTH / 2 - 10;
            game.player.y = CONFIG.CANVAS_HEIGHT - 40;
            
            // Clear arrays
            game.bullets = [];
            game.centipede = [];
            game.enemies = [];
            game.powerUps = [];
            
            // Create new level
            createLevel();
            updateDisplay();
            
            // Hide modals
            document.getElementById("gameOverModal").style.display = "none";
            
            // Start game loop
            gameLoop();
            
            trackEvent("game_start");
        }

        // Create Level
        function createLevel() {
            // Create centipede
            game.centipede = [];
            const segmentCount = 8 + game.level;
            for (let i = 0; i < segmentCount; i++) {
                game.centipede.push({
                    x: i * CONFIG.GRID_SIZE,
                    y: 0,
                    width: CONFIG.GRID_SIZE - 2,
                    height: CONFIG.GRID_SIZE - 2,
                    direction: 1,
                    isHead: i === 0
                });
            }
            
            // Add some random enemies
            for (let i = 0; i < game.level; i++) {
                game.enemies.push({
                    x: Math.random() * (CONFIG.CANVAS_WIDTH - 20),
                    y: Math.random() * 100 + 50,
                    width: 15,
                    height: 15,
                    speed: 1 + Math.random() * 2,
                    direction: Math.random() < 0.5 ? -1 : 1
                });
            }
        }

        // Create Mushrooms
        function createMushrooms() {
            game.mushrooms = [];
            for (let i = 0; i < CONFIG.MUSHROOM_COUNT; i++) {
                game.mushrooms.push({
                    x: Math.floor(Math.random() * (CONFIG.CANVAS_WIDTH / CONFIG.GRID_SIZE)) * CONFIG.GRID_SIZE,
                    y: Math.floor(Math.random() * ((CONFIG.CANVAS_HEIGHT - 100) / CONFIG.GRID_SIZE)) * CONFIG.GRID_SIZE + 50,
                    width: CONFIG.GRID_SIZE - 2,
                    height: CONFIG.GRID_SIZE - 2,
                    health: 4,
                    maxHealth: 4
                });
            }
        }

        // Game Loop
        function gameLoop() {
            if (!game.gameRunning || game.gameOver) return;
            
            if (!game.gamePaused) {
                updateGame();
            }
            
            render();
            requestAnimationFrame(gameLoop);
        }

        // Update Game
        function updateGame() {
            // Move player
            if (game.moveDirection) {
                movePlayer(game.moveDirection);
            }
            
            // Update bullets
            updateBullets();
            
            // Update centipede
            updateCentipede();
            
            // Update enemies
            updateEnemies();
            
            // Check collisions
            checkCollisions();
            
            // Check level completion
            if (game.centipede.length === 0) {
                nextLevel();
            }
        }

        // Move Player
        function movePlayer(direction) {
            const speed = CONFIG.PLAYER_SPEED;
            
            switch (direction) {
                case 'up':
                    if (game.player.y > CONFIG.CANVAS_HEIGHT * 0.7) {
                        game.player.y = Math.max(CONFIG.CANVAS_HEIGHT * 0.7, game.player.y - speed);
                    }
                    break;
                case 'down':
                    game.player.y = Math.min(CONFIG.CANVAS_HEIGHT - game.player.height, game.player.y + speed);
                    break;
                case 'left':
                    game.player.x = Math.max(0, game.player.x - speed);
                    break;
                case 'right':
                    game.player.x = Math.min(CONFIG.CANVAS_WIDTH - game.player.width, game.player.x + speed);
                    break;
            }
        }

        // Update Bullets
        function updateBullets() {
            for (let i = game.bullets.length - 1; i >= 0; i--) {
                const bullet = game.bullets[i];
                bullet.y -= CONFIG.BULLET_SPEED;
                
                // Remove bullets that are off screen
                if (bullet.y < 0) {
                    game.bullets.splice(i, 1);
                }
            }
        }

        // Update Centipede
        function updateCentipede() {
            for (let i = 0; i < game.centipede.length; i++) {
                const segment = game.centipede[i];
                
                // Move horizontally
                segment.x += segment.direction * CONFIG.CENTIPEDE_SPEED;
                
                // Check boundaries and obstacles
                let shouldTurn = false;
                
                if (segment.x <= 0 || segment.x >= CONFIG.CANVAS_WIDTH - segment.width) {
                    shouldTurn = true;
                }
                
                // Check mushroom collisions
                for (const mushroom of game.mushrooms) {
                    if (checkCollision(segment, mushroom)) {
                        shouldTurn = true;
                        break;
                    }
                }
                
                if (shouldTurn) {
                   segment.direction *= -1;
                   segment.y += CONFIG.GRID_SIZE;
                   
                   // If centipede reaches player area, game over
                   if (segment.y > CONFIG.CANVAS_HEIGHT * 0.8) {
                       loseLife();
                   }
               }
           }
       }

       // Update Enemies
       function updateEnemies() {
           for (let i = 0; i < game.enemies.length; i++) {
               const enemy = game.enemies[i];
               enemy.x += enemy.direction * enemy.speed;
               
               // Bounce off walls
               if (enemy.x <= 0 || enemy.x >= CONFIG.CANVAS_WIDTH - enemy.width) {
                   enemy.direction *= -1;
               }
               
               // Randomly change direction
               if (Math.random() < 0.01) {
                   enemy.direction *= -1;
               }
           }
       }

       // Fire Shot
       function fireShot() {
           if (!game.gameRunning || game.gamePaused) return;
           
           game.bullets.push({
               x: game.player.x + game.player.width / 2 - 2,
               y: game.player.y,
               width: 4,
               height: 8
           });
       }

       // Check Collisions
       function checkCollisions() {
           // Bullet vs Centipede
           for (let i = game.bullets.length - 1; i >= 0; i--) {
               const bullet = game.bullets[i];
               
               for (let j = game.centipede.length - 1; j >= 0; j--) {
                   const segment = game.centipede[j];
                   
                   if (checkCollision(bullet, segment)) {
                       // Remove bullet
                       game.bullets.splice(i, 1);
                       
                       // Add score (bonus for head)
                       const points = segment.isHead ? 100 : 10;
                       addScore(points);
                       
                       // Create mushroom where segment was destroyed
                       game.mushrooms.push({
                           x: Math.floor(segment.x / CONFIG.GRID_SIZE) * CONFIG.GRID_SIZE,
                           y: Math.floor(segment.y / CONFIG.GRID_SIZE) * CONFIG.GRID_SIZE,
                           width: CONFIG.GRID_SIZE - 2,
                           height: CONFIG.GRID_SIZE - 2,
                           health: 4,
                           maxHealth: 4
                       });
                       
                       // Split centipede
                       if (j < game.centipede.length - 1) {
                           // Make next segment the new head
                           game.centipede[j + 1].isHead = true;
                       }
                       
                       // Remove segment
                       game.centipede.splice(j, 1);
                       break;
                   }
               }
           }
           
           // Bullet vs Mushrooms
           for (let i = game.bullets.length - 1; i >= 0; i--) {
               const bullet = game.bullets[i];
               
               for (let j = game.mushrooms.length - 1; j >= 0; j--) {
                   const mushroom = game.mushrooms[j];
                   
                   if (checkCollision(bullet, mushroom)) {
                       game.bullets.splice(i, 1);
                       mushroom.health--;
                       
                       if (mushroom.health <= 0) {
                           game.mushrooms.splice(j, 1);
                           addScore(1);
                       }
                       break;
                   }
               }
           }
           
           // Bullet vs Enemies
           for (let i = game.bullets.length - 1; i >= 0; i--) {
               const bullet = game.bullets[i];
               
               for (let j = game.enemies.length - 1; j >= 0; j--) {
                   const enemy = game.enemies[j];
                   
                   if (checkCollision(bullet, enemy)) {
                       game.bullets.splice(i, 1);
                       game.enemies.splice(j, 1);
                       addScore(50);
                       break;
                   }
               }
           }
           
           // Player vs Centipede
           for (const segment of game.centipede) {
               if (checkCollision(game.player, segment)) {
                   loseLife();
                   break;
               }
           }
           
           // Player vs Enemies
           for (const enemy of game.enemies) {
               if (checkCollision(game.player, enemy)) {
                   loseLife();
                   break;
               }
           }
       }

       // Check Collision Helper
       function checkCollision(rect1, rect2) {
           return rect1.x < rect2.x + rect2.width &&
                  rect1.x + rect1.width > rect2.x &&
                  rect1.y < rect2.y + rect2.height &&
                  rect1.y + rect1.height > rect2.y;
       }

       // Add Score
       function addScore(points) {
           game.score += points;
           updateDisplay();
           
           // Check for new best score
           if (game.score > game.bestScore) {
               game.bestScore = game.score;
               localStorage.setItem("centipede-chaos-best", game.bestScore.toString());
               document.getElementById("bestScore").textContent = game.bestScore;
           }
       }

       // Lose Life
       function loseLife() {
           game.lives--;
           updateDisplay();
           
           if (game.lives <= 0) {
               endGame();
           } else {
               // Reset player position
               game.player.x = CONFIG.CANVAS_WIDTH / 2 - 10;
               game.player.y = CONFIG.CANVAS_HEIGHT - 40;
               
               // Brief invincibility
               setTimeout(() => {
                   // Game continues
               }, 1000);
           }
       }

       // Next Level
       function nextLevel() {
           game.level++;
           addScore(100 * game.level); // Level completion bonus
           
           // Add more mushrooms
           for (let i = 0; i < 5; i++) {
               game.mushrooms.push({
                   x: Math.floor(Math.random() * (CONFIG.CANVAS_WIDTH / CONFIG.GRID_SIZE)) * CONFIG.GRID_SIZE,
                   y: Math.floor(Math.random() * ((CONFIG.CANVAS_HEIGHT - 100) / CONFIG.GRID_SIZE)) * CONFIG.GRID_SIZE + 50,
                   width: CONFIG.GRID_SIZE - 2,
                   height: CONFIG.GRID_SIZE - 2,
                   health: 4,
                   maxHealth: 4
               });
           }
           
           createLevel();
           updateDisplay();
       }

       // End Game
       function endGame() {
           game.gameOver = true;
           game.gameRunning = false;
           
           // Update modal
           document.getElementById("finalScore").textContent = game.score;
           document.getElementById("finalLevel").textContent = game.level;
           document.getElementById("modalBestScore").textContent = game.bestScore;
           
           // Show game over modal
           document.getElementById("gameOverModal").style.display = "flex";
           
           trackEvent("game_end", { score: game.score, level: game.level });
       }

       // Render Game
       function render() {
           const ctx = game.ctx;
           
           // Clear canvas with gradient background
           const gradient = ctx.createLinearGradient(0, 0, 0, CONFIG.CANVAS_HEIGHT);
           gradient.addColorStop(0, "#0f0f23");
           gradient.addColorStop(1, "#1a1a2e");
           ctx.fillStyle = gradient;
           ctx.fillRect(0, 0, CONFIG.CANVAS_WIDTH, CONFIG.CANVAS_HEIGHT);
           
           // Draw player area divider
           ctx.strokeStyle = "#444";
           ctx.lineWidth = 2;
           ctx.setLineDash([5, 5]);
           ctx.beginPath();
           ctx.moveTo(0, CONFIG.CANVAS_HEIGHT * 0.7);
           ctx.lineTo(CONFIG.CANVAS_WIDTH, CONFIG.CANVAS_HEIGHT * 0.7);
           ctx.stroke();
           ctx.setLineDash([]);
           
           // Draw mushrooms
           for (const mushroom of game.mushrooms) {
               const healthRatio = mushroom.health / mushroom.maxHealth;
               ctx.fillStyle = `hsl(${120 * healthRatio}, 70%, 50%)`;
               ctx.fillRect(mushroom.x, mushroom.y, mushroom.width, mushroom.height);
               
               // Mushroom cap effect
               ctx.fillStyle = `hsl(${120 * healthRatio}, 70%, 70%)`;
               ctx.fillRect(mushroom.x + 2, mushroom.y + 2, mushroom.width - 4, mushroom.height / 2);
           }
           
           // Draw centipede
           for (let i = 0; i < game.centipede.length; i++) {
               const segment = game.centipede[i];
               
               if (segment.isHead) {
                   // Head - different color
                   ctx.fillStyle = "#ff6b6b";
                   ctx.fillRect(segment.x, segment.y, segment.width, segment.height);
                   
                   // Eyes
                   ctx.fillStyle = "#fff";
                   ctx.fillRect(segment.x + 4, segment.y + 4, 3, 3);
                   ctx.fillRect(segment.x + segment.width - 7, segment.y + 4, 3, 3);
               } else {
                   // Body segments
                   const hue = (i * 30) % 360;
                   ctx.fillStyle = `hsl(${hue}, 70%, 50%)`;
                   ctx.fillRect(segment.x, segment.y, segment.width, segment.height);
                   
                   // Segment detail
                   ctx.fillStyle = `hsl(${hue}, 70%, 70%)`;
                   ctx.fillRect(segment.x + 2, segment.y + 2, segment.width - 4, segment.height - 4);
               }
           }
           
           // Draw enemies
           for (const enemy of game.enemies) {
               ctx.fillStyle = "#ff4757";
               ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
               
               // Enemy glow effect
               ctx.shadowColor = "#ff4757";
               ctx.shadowBlur = 10;
               ctx.fillRect(enemy.x + 2, enemy.y + 2, enemy.width - 4, enemy.height - 4);
               ctx.shadowBlur = 0;
           }
           
           // Draw player
           ctx.fillStyle = "#00d4ff";
           ctx.fillRect(game.player.x, game.player.y, game.player.width, game.player.height);
           
           // Player ship details
           ctx.fillStyle = "#fff";
           ctx.fillRect(game.player.x + 8, game.player.y + 2, 4, 8);
           ctx.fillStyle = "#ffd700";
           ctx.fillRect(game.player.x + 6, game.player.y + 12, 8, 4);
           
           // Draw bullets
           for (const bullet of game.bullets) {
               ctx.fillStyle = "#ffd700";
               ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
               
               // Bullet trail effect
               ctx.fillStyle = "rgba(255, 215, 0, 0.5)";
               ctx.fillRect(bullet.x, bullet.y + bullet.height, bullet.width, 4);
           }
           
           // Draw paused overlay
           if (game.gamePaused) {
               ctx.fillStyle = "rgba(0, 0, 0, 0.7)";
               ctx.fillRect(0, 0, CONFIG.CANVAS_WIDTH, CONFIG.CANVAS_HEIGHT);
               
               ctx.fillStyle = "#fff";
               ctx.font = "24px Orbitron";
               ctx.textAlign = "center";
               ctx.fillText("PAUSED", CONFIG.CANVAS_WIDTH / 2, CONFIG.CANVAS_HEIGHT / 2);
               
               ctx.font = "14px Inter";
               ctx.fillText("Press P or click Pause to continue", CONFIG.CANVAS_WIDTH / 2, CONFIG.CANVAS_HEIGHT / 2 + 30);
           }
       }

       // Handle Key Down
       function handleKeyDown(e) {
           game.keys[e.code] = true;
           
           switch (e.code) {
               case "ArrowUp":
               case "KeyW":
                   e.preventDefault();
                   startMove("up");
                   break;
               case "ArrowDown":
               case "KeyS":
                   e.preventDefault();
                   startMove("down");
                   break;
               case "ArrowLeft":
               case "KeyA":
                   e.preventDefault();
                   startMove("left");
                   break;
               case "ArrowRight":
               case "KeyD":
                   e.preventDefault();
                   startMove("right");
                   break;
               case "Space":
                   e.preventDefault();
                   fireShot();
                   break;
               case "KeyP":
                   e.preventDefault();
                   togglePause();
                   break;
               case "KeyN":
                   e.preventDefault();
                   if (game.gameOver) startNewGame();
                   break;
           }
       }

       // Handle Key Up
       function handleKeyUp(e) {
           game.keys[e.code] = false;
           
           switch (e.code) {
               case "ArrowUp":
               case "KeyW":
               case "ArrowDown":
               case "KeyS":
               case "ArrowLeft":
               case "KeyA":
               case "ArrowRight":
               case "KeyD":
                   stopMove();
                   break;
           }
       }

       // Start Move
       function startMove(direction) {
           if (game.moveDirection === direction) return;
           
           stopMove();
           game.moveDirection = direction;
           game.moveInterval = setInterval(() => {
               if (game.gameRunning && !game.gamePaused) {
                   movePlayer(direction);
               }
           }, 16); // ~60fps
       }

       // Stop Move
       function stopMove() {
           if (game.moveInterval) {
               clearInterval(game.moveInterval);
               game.moveInterval = null;
           }
           game.moveDirection = null;
       }

       // Setup Touch Controls
       function setupTouchControls() {
           let startX, startY;
           
           game.canvas.addEventListener("touchstart", (e) => {
               startX = e.touches[0].clientX;
               startY = e.touches[0].clientY;
               e.preventDefault();
           });
           
           game.canvas.addEventListener("touchend", (e) => {
               if (!startX || !startY) return;
               
               const endX = e.changedTouches[0].clientX;
               const endY = e.changedTouches[0].clientY;
               
               const deltaX = endX - startX;
               const deltaY = endY - startY;
               
               const minSwipeDistance = 30;
               
               if (Math.abs(deltaX) > Math.abs(deltaY)) {
                   if (Math.abs(deltaX) > minSwipeDistance) {
                       const direction = deltaX > 0 ? "right" : "left";
                       startMove(direction);
                       setTimeout(stopMove, 200);
                   }
               } else {
                   if (Math.abs(deltaY) > minSwipeDistance) {
                       const direction = deltaY > 0 ? "down" : "up";
                       startMove(direction);
                       setTimeout(stopMove, 200);
                   }
               }
               
               startX = null;
               startY = null;
               e.preventDefault();
           });
           
           // Tap to shoot
           game.canvas.addEventListener("click", (e) => {
               if (game.gameRunning && !game.gamePaused) {
                   fireShot();
               }
               e.preventDefault();
           });
       }

       // Update Display
       function updateDisplay() {
           document.getElementById("currentScore").textContent = game.score.toLocaleString();
           document.getElementById("gameLevel").textContent = game.level;
           document.getElementById("playerLives").textContent = game.lives;
       }

       // Toggle Pause
       function togglePause() {
           if (!game.gameRunning || game.gameOver) return;
           
           game.gamePaused = !game.gamePaused;
           document.getElementById("pauseButton").textContent = game.gamePaused ? "▶️ Resume" : "⏸️ Pause";
           
           if (!game.gamePaused) {
               gameLoop();
           }
       }

       // Start New Game
       function startNewGame() {
           document.getElementById("gameOverModal").style.display = "none";
           resetGame();
       }

       // Share Score
       function shareScore() {
           const text = `I just scored ${game.score.toLocaleString()} points in Centipede Chaos! Can you beat my score? Play free at gameszone99.com`;
           
           if (navigator.share) {
               navigator.share({
                   title: "Centipede Chaos - High Score!",
                   text: text,
                   url: window.location.href
               });
           } else if (navigator.clipboard) {
               navigator.clipboard.writeText(text);
               alert("Score copied to clipboard!");
           } else {
               prompt("Copy this text to share your score:", text);
           }
       }

       // Show Instructions
       function showInstructions() {
           alert("🎯 HOW TO PLAY CENTIPEDE CHAOS\n\n🎮 CONTROLS:\n• Arrow keys or WASD to move\n• Spacebar or click/tap to shoot\n• P to pause\n\n🎯 OBJECTIVE:\n• Destroy all centipede segments\n• Avoid touching enemies\n• Shoot mushrooms to clear paths\n• Survive and advance levels\n\n💡 TIPS:\n• Target the head for bonus points\n• Use mushrooms as barriers\n• Create strategic shooting lanes");
       }

       // Show Leaderboard
       function showLeaderboard() {
           const scores = JSON.parse(localStorage.getItem("centipede-chaos-scores") || "[]");
           
           if (scores.length === 0) {
               alert("No scores yet! Play a game to set your first record.");
               return;
           }
           
           let leaderboardText = "🏆 LOCAL LEADERBOARD\n\n";
           scores.slice(0, 10).forEach((score, index) => {
               leaderboardText += `${index + 1}. ${score.toLocaleString()} points\n`;
           });
           
           alert(leaderboardText);
       }

       // Toggle Fullscreen
       function toggleFullscreen() {
           if (!document.fullscreenElement) {
               document.documentElement.requestFullscreen();
           } else {
               document.exitFullscreen();
           }
       }

       // Analytics Tracking
       function trackEvent(action, properties = {}) {
           // Google Analytics 4 event tracking
           if (typeof gtag !== 'undefined') {
               gtag('event', action, {
                   game_name: 'centipede_chaos',
                   ...properties
               });
           }
           
           // Console log for debugging
           console.log(`Event: ${action}`, properties);
       }

       // Save Score to Local Leaderboard
       function saveScore() {
           const scores = JSON.parse(localStorage.getItem("centipede-chaos-scores") || "[]");
           scores.push(game.score);
           scores.sort((a, b) => b - a);
           scores.splice(10); // Keep only top 10
           localStorage.setItem("centipede-chaos-scores", JSON.stringify(scores));
       }

       // Initialize when page loads
       document.addEventListener("DOMContentLoaded", () => {
           initGame();
       });

       // Handle page visibility for pause
       document.addEventListener("visibilitychange", () => {
           if (document.hidden && game.gameRunning && !game.gamePaused) {
               togglePause();
           }
       });

       // Prevent context menu on canvas
       document.getElementById("gameCanvas").addEventListener("contextmenu", (e) => {
           e.preventDefault();
       });

       // Add keyboard shortcuts info
       document.addEventListener("keydown", (e) => {
           if (e.code === "F1") {
               e.preventDefault();
               showInstructions();
           }
       });
   </script>
</body>
</html>