<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern Memory - Free HTML5 Game | GameHub 99</title>
    <meta name="description" content="Play Pattern Memory for free! Challenge your mind with this addictive puzzle game that tests your memory skills. Mobile-friendly browser game with no download required.">
    <meta name="keywords" content="pattern memory, memory game, puzzle game, html5 game, free online game, browser game, mobile game, brain training">
    <meta name="author" content="GameHub 99">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="game">
    <meta property="og:url" content="https://gamehub99.com/games/pattern-memory.html">
    <meta property="og:title" content="Pattern Memory - Free HTML5 Game">
    <meta property="og:description" content="Challenge your mind with this addictive memory puzzle game!">
    <meta property="og:image" content="https://gamehub99.com/assets/pattern-memory-og.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://gamehub99.com/games/pattern-memory.html">
    <meta property="twitter:title" content="Pattern Memory - Free HTML5 Game">
    <meta property="twitter:description" content="Challenge your mind with this addictive memory puzzle game!">
    <meta property="twitter:image" content="https://gamehub99.com/assets/pattern-memory-og.jpg">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark-gradient: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 100%);
            --accent-color: #00d4ff;
            --success-color: #00ff88;
            --warning-color: #ffaa00;
            --danger-color: #ff4757;
            --text-primary: #ffffff;
            --text-secondary: #b8c1ec;
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --shadow-glow: 0 0 40px rgba(0, 212, 255, 0.3);
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: "Inter", sans-serif;
            background: var(--dark-gradient);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .ad-container-top, .ad-container-bottom {
            width: 100%;
            min-height: 90px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--card-border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .ad-placeholder {
            width: 728px;
            height: 90px;
            background: linear-gradient(45deg, #333, #555);
            border: 2px dashed #666;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 14px;
            border-radius: 8px;
        }

        .header {
            padding: 1rem 0;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .game-title {
            font-family: "Orbitron", monospace;
            font-size: 2rem;
            font-weight: 900;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: var(--shadow-glow);
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 8px 16px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .nav-button:hover {
            background: var(--accent-color);
            color: #000;
            transform: translateY(-2px);
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
            flex: 1;
        }

        .game-section {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 15px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-card);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stats-section {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stat-box {
            text-align: center;
            background: var(--card-bg);
            padding: 0.8rem;
            border-radius: 8px;
            border: 1px solid var(--card-border);
            min-width: 80px;
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.3rem;
        }

        .stat-value {
            font-family: "Orbitron", monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .game-controls {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .control-button {
            padding: 8px 16px;
            background: var(--secondary-gradient);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-card);
        }

        .control-button.new-game {
            background: var(--success-color);
        }

        .control-button.pause {
            background: var(--warning-color);
        }

        .game-area {
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 15px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            position: relative;
            text-align: center;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 2rem 0;
            max-width: 300px;
        }

        .pattern-tile {
            aspect-ratio: 1;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .pattern-tile:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--card-bg);
            border-radius: 13px;
            transition: all 0.3s ease;
        }

        .pattern-tile span {
            position: relative;
            z-index: 1;
        }

        .pattern-tile.active {
            border-color: var(--accent-color);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
            transform: scale(1.05);
        }

        .pattern-tile.active:before {
            background: var(--accent-color);
        }

        .pattern-tile.correct {
            border-color: var(--success-color);
            animation: correctPulse 0.5s ease;
        }

        .pattern-tile.wrong {
            border-color: var(--danger-color);
            animation: wrongShake 0.5s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); box-shadow: 0 0 30px var(--success-color); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .game-status {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--accent-color);
        }

        .start-button {
            padding: 1rem 2rem;
            background: var(--primary-gradient);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-card);
        }

        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow);
        }

        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
            max-width: 250px;
            margin-left: auto;
            margin-right: auto;
        }

        .mobile-control {
            aspect-ratio: 1;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            user-select: none;
        }

        .mobile-control:active {
            transform: scale(0.95);
            background: var(--accent-color);
        }

        .mobile-control.empty {
            visibility: hidden;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .sidebar-section {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 15px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-card);
        }

        .sidebar-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--accent-color);
        }

        .instructions {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .instructions ul {
            margin-left: 1rem;
            margin-top: 0.5rem;
        }

        .instructions li {
            margin-bottom: 0.5rem;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: var(--dark-gradient);
            margin: 10% auto;
            padding: 2rem;
            border: 2px solid var(--card-border);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            position: relative;
            box-shadow: var(--shadow-glow);
        }

        .modal-title {
            font-family: "Orbitron", monospace;
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 1rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-score {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-color);
            margin: 1rem 0;
            font-family: "Orbitron", monospace;
        }

        .modal-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .modal-stat {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid var(--card-border);
        }

        .modal-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .modal-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .modal-button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-card);
        }

        .modal-button.primary {
            background: var(--accent-color);
            color: #000;
        }

        .modal-button.secondary {
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--card-border);
        }

        .pulse {
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
                padding: 1rem;
                gap: 1rem;
            }

            .game-title {
                font-size: 1.5rem;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .nav-buttons {
                justify-content: center;
            }

            .game-header {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }

            .stats-section {
                justify-content: center;
            }

            .game-controls {
                justify-content: center;
            }

            .mobile-controls {
                display: grid;
            }

            .pattern-grid {
                max-width: 250px;
            }

            .ad-placeholder {
                width: 320px;
                height: 50px;
                font-size: 12px;
            }

            .modal-content {
                margin: 20% auto;
                padding: 1.5rem;
            }

            .modal-title {
                font-size: 1.5rem;
            }

            .modal-score {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .game-section, .sidebar-section {
                padding: 1rem;
            }

            .pattern-grid {
                max-width: 200px;
                gap: 0.5rem;
            }

            .pattern-tile {
                font-size: 1.5rem;
            }

            .game-title {
                font-size: 1.2rem;
            }

            .nav-button {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .control-button {
                padding: 6px 12px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <!-- Top Ad Container -->
    <div class="ad-container-top">
        <div class="ad-placeholder">728x90 Header Advertisement</div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="game-title">üß† Pattern Memory</h1>
            <nav class="nav-buttons">
                <a href="/" class="nav-button">üè† Home</a>
                <a href="/games" class="nav-button">üéÆ More Games</a>
                <a href="#" class="nav-button" onclick="showInstructions()">‚ùì How to Play</a>
                <a href="#" class="nav-button" onclick="toggleFullscreen()">üì± Fullscreen</a>
            </nav>
        </div>
    </header>

    <!-- Main Game Container -->
    <div class="game-container">
        <!-- Game Section -->
        <main class="game-section">
            <div class="game-header">
                <div class="stats-section">
                    <div class="stat-box">
                        <div class="stat-label">Score</div>
                        <div class="stat-value" id="currentScore">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Best</div>
                        <div class="stat-value" id="bestScore">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Level</div>
                        <div class="stat-value" id="gameLevel">1</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Streak</div>
                        <div class="stat-value" id="streakCount">0</div>
                    </div>
                </div>
                
                <div class="game-controls">
                    <button class="control-button new-game" onclick="startNewGame()">üÜï New Game</button>
                    <button class="control-button" onclick="showLeaderboard()">üèÜ Scores</button>
                    <button class="control-button" onclick="shareScore()">üì± Share</button>
                </div>
            </div>

            <!-- Game Area -->
            <div class="game-area" id="gameArea">
                <div class="game-status" id="gameStatus">Ready to challenge your memory?</div>
                <button class="start-button" onclick="startGame()" id="startButton">üéÆ Start Game</button>
                
                <div class="pattern-grid" id="patternGrid" style="display: none;">
                    <div class="pattern-tile" data-index="0"><span>üî¥</span></div>
                    <div class="pattern-tile" data-index="1"><span>üîµ</span></div>
                    <div class="pattern-tile" data-index="2"><span>üü¢</span></div>
                    <div class="pattern-tile" data-index="3"><span>üü°</span></div>
                    <div class="pattern-tile" data-index="4"><span>üü£</span></div>
                    <div class="pattern-tile" data-index="5"><span>üü†</span></div>
                    <div class="pattern-tile" data-index="6"><span>üü§</span></div>
                    <div class="pattern-tile" data-index="7"><span>‚ö´</span></div>
                    <div class="pattern-tile" data-index="8"><span>‚ö™</span></div>
                </div>
            </div>

            <!-- Mobile Controls -->
            <div class="mobile-controls">
                <div class="mobile-control" onclick="showInstructions()">‚ùì</div>
                <div class="mobile-control" onclick="startNewGame()">üÜï</div>
                <div class="mobile-control" onclick="shareScore()">üì±</div>
            </div>
        </main>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-title">üéØ How to Play</h3>
                <div class="instructions">
                    <p><strong>Challenge your memory with pattern sequences!</strong></p>
                    <ul>
                        <li>Watch the pattern sequence carefully</li>
                        <li>Repeat the pattern by clicking tiles</li>
                        <li>Each level adds one more step</li>
                        <li>Score points for correct sequences</li>
                        <li>Beat your high score!</li>
                    </ul>
                </div>
            </div>

            <div class="sidebar-section" style="min-height: 250px; display: flex; align-items: center; justify-content: center;">
                <div style="width: 250px; height: 250px; background: linear-gradient(45deg, #333, #555); border: 2px dashed #666; display: flex; align-items: center; justify-content: center; color: #999; font-size: 14px; border-radius: 8px; text-align: center;">
                    250x250<br>Sidebar Ad
                </div>
            </div>
        </aside>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">üéÆ Game Over!</h2>
            <div class="modal-score" id="modalScore">0</div>
            <div class="modal-stats">
                <div class="modal-stat">
                    <div class="modal-stat-label">Level Reached</div>
                    <div class="modal-stat-value" id="modalLevel">1</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-label">Best Streak</div>
                    <div class="modal-stat-value" id="modalStreak">0</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-label">Your Best</div>
                    <div class="modal-stat-value" id="modalBest">0</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-label">Accuracy</div>
                    <div class="modal-stat-value" id="modalAccuracy">0%</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button primary" onclick="playAgain()">üéÆ Play Again</button>
                <button class="modal-button secondary" onclick="shareScore()">üì± Share Score</button>
                <button class="modal-button secondary" onclick="closeModal()">‚ùå Close</button>
            </div>
        </div>
    </div>

    <!-- Bottom Ad Container -->
    <div class="ad-container-bottom">
        <div class="ad-placeholder">728x90 Footer Advertisement</div>
    </div>

    <script>
        // Game State
        const game = {
            score: 0,
            bestScore: parseInt(localStorage.getItem("patternMemoryBest")) || 0,
            level: 1,
            streak: 0,
            sequence: [],
            playerSequence: [],
            isShowing: false,
            isPlaying: false,
            gameActive: false,
            currentStep: 0,
            totalAttempts: 0,
            correctAttempts: 0,
            startTime: 0
        };

        // Initialize game
        function initGame() {
            document.getElementById("bestScore").textContent = game.bestScore.toLocaleString();
            updateDisplay();
            
            // Add click listeners to pattern tiles
            const tiles = document.querySelectorAll('.pattern-tile');
            tiles.forEach(tile => {
                tile.addEventListener('click', () => handleTileClick(parseInt(tile.dataset.index)));
            });
        }

        // Start new game
        function startGame() {
            game.score = 0;
            game.level = 1;
            game.streak = 0;
            game.sequence = [];
            game.playerSequence = [];
            game.currentStep = 0;
            game.totalAttempts = 0;
            game.correctAttempts = 0;
            game.gameActive = true;
            game.startTime = Date.now();
            
            document.getElementById("startButton").style.display = "none";
            document.getElementById("patternGrid").style.display = "grid";
            document.getElementById("gameStatus").textContent = "Watch the pattern...";
            
            updateDisplay();
            nextLevel();
        }

        function startNewGame() {
            if (game.gameActive) {
                if (confirm("Are you sure you want to start a new game? Your current progress will be lost.")) {
                    resetGame();
                    startGame();
                }
            } else {
                startGame();
            }
        }

        // Reset game state
        function resetGame() {
            game.gameActive = false;
            game.isShowing = false;
            game.isPlaying = false;
            
            document.getElementById("startButton").style.display = "block";
            document.getElementById("patternGrid").style.display = "none";
            document.getElementById("gameStatus").textContent = "Ready to challenge your memory?";
            
            // Clear all tile animations
            const tiles = document.querySelectorAll('.pattern-tile');
            tiles.forEach(tile => {
                tile.classList.remove('active', 'correct', 'wrong');
            });
        }

        // Generate next level
        function nextLevel() {
            if (!game.gameActive) return;
            
            game.level++;
            game.sequence.push(Math.floor(Math.random() * 9));
            game.playerSequence = [];
            game.currentStep = 0;
            
            updateDisplay();
            showSequence();
        }

        // Show sequence to player
        function showSequence() {
            game.isShowing = true;
            game.isPlaying = false;
            
            document.getElementById("gameStatus").textContent = `Level ${game.level} - Watch carefully!`;
            
            let index = 0;
            const showNext = () => {
                if (index < game.sequence.length && game.gameActive) {
                    const tileIndex = game.sequence[index];
                    const tile = document.querySelector(`[data-index="${tileIndex}"]`);
                    
                    // Light up tile
                    tile.classList.add('active');
                    
                    // Sound effect (optional)
                    playSound('show');
                    
                    setTimeout(() => {
                        tile.classList.remove('active');
                        index++;
                        if (index < game.sequence.length) {
                            setTimeout(showNext, 200);
                        } else {
                            setTimeout(() => {
                                game.isShowing = false;
                                game.isPlaying = true;
                                document.getElementById("gameStatus").textContent = "Now repeat the pattern!";
                            }, 500);
                        }
                    }, 600);
                }
            };
            
            setTimeout(showNext, 1000);
        }

        // Handle tile click
        function handleTileClick(tileIndex) {
            if (!game.isPlaying || game.isShowing || !game.gameActive) return;
            
            const tile = document.querySelector(`[data-index="${tileIndex}"]`);
            game.totalAttempts++;
            
            // Check if correct
            if (tileIndex === game.sequence[game.currentStep]) {
                // Correct tile
                tile.classList.add('correct');
                game.playerSequence.push(tileIndex);
                game.currentStep++;
                game.correctAttempts++;
                
// Calculate score
               const pointsEarned = game.level * 10;
               game.score += pointsEarned;
               game.streak++;
               
               playSound('correct');
               
               setTimeout(() => {
                   tile.classList.remove('correct');
               }, 300);
               
               // Check if sequence complete
               if (game.currentStep >= game.sequence.length) {
                   // Level complete!
                   setTimeout(() => {
                       document.getElementById("gameStatus").textContent = `Great! +${pointsEarned} points`;
                       updateDisplay();
                       setTimeout(() => {
                           nextLevel();
                       }, 1500);
                   }, 500);
               }
           } else {
               // Wrong tile - game over
               tile.classList.add('wrong');
               game.streak = 0;
               
               playSound('wrong');
               
               setTimeout(() => {
                   tile.classList.remove('wrong');
                   gameOver();
               }, 500);
           }
           
           updateDisplay();
       }

       // Game over
       function gameOver() {
           game.gameActive = false;
           game.isPlaying = false;
           game.isShowing = false;
           
           // Update best score
           if (game.score > game.bestScore) {
               game.bestScore = game.score;
               localStorage.setItem("patternMemoryBest", game.bestScore);
           }
           
           // Save score to history
           saveScore(game.score);
           
           // Show game over modal
           showGameOverModal();
           
           updateDisplay();
       }

       // Show game over modal
       function showGameOverModal() {
           const modal = document.getElementById("gameOverModal");
           const accuracy = game.totalAttempts > 0 ? Math.round((game.correctAttempts / game.totalAttempts) * 100) : 0;
           
           document.getElementById("modalScore").textContent = game.score.toLocaleString();
           document.getElementById("modalLevel").textContent = game.level - 1;
           document.getElementById("modalStreak").textContent = game.streak;
           document.getElementById("modalBest").textContent = game.bestScore.toLocaleString();
           document.getElementById("modalAccuracy").textContent = accuracy + "%";
           
           modal.style.display = "block";
           
           // Add celebration effect for new high score
           if (game.score === game.bestScore && game.score > 0) {
               document.getElementById("modalScore").classList.add("pulse");
               document.querySelector(".modal-title").textContent = "üéâ New High Score!";
           }
       }

       // Close modal
       function closeModal() {
           document.getElementById("gameOverModal").style.display = "none";
           resetGame();
       }

       // Play again
       function playAgain() {
           closeModal();
           startGame();
       }

       // Update display
       function updateDisplay() {
           document.getElementById("currentScore").textContent = game.score.toLocaleString();
           document.getElementById("bestScore").textContent = game.bestScore.toLocaleString();
           document.getElementById("gameLevel").textContent = game.level;
           document.getElementById("streakCount").textContent = game.streak;
       }

       // Save score to local storage
       function saveScore(score) {
           const scores = JSON.parse(localStorage.getItem("patternMemoryScores") || "[]");
           scores.push({
               score: score,
               level: game.level - 1,
               date: new Date().toLocaleDateString(),
               accuracy: game.totalAttempts > 0 ? Math.round((game.correctAttempts / game.totalAttempts) * 100) : 0
           });
           
           // Keep only top 10 scores
           scores.sort((a, b) => b.score - a.score);
           scores.splice(10);
           
           localStorage.setItem("patternMemoryScores", JSON.stringify(scores));
       }

       // Show leaderboard
       function showLeaderboard() {
           const scores = JSON.parse(localStorage.getItem("patternMemoryScores") || "[]");
           
           let message = "üèÜ High Scores:\n\n";
           
           if (scores.length === 0) {
               message += "No scores yet! Be the first!";
           } else {
               scores.slice(0, 5).forEach((score, index) => {
                   message += `#${index + 1}: ${score.score.toLocaleString()} pts (Level ${score.level})\n`;
                   message += `     ${score.accuracy}% accuracy - ${score.date}\n\n`;
               });
           }
           
           alert(message);
       }

       // Share score
       function shareScore() {
           const text = `üß† I just scored ${game.score.toLocaleString()} points in Pattern Memory and reached level ${game.level}! Can you beat my memory skills? üèÜ`;
           
           if (navigator.share) {
               navigator.share({
                   title: "Pattern Memory - My Score",
                   text: text,
                   url: window.location.href
               });
           } else {
               navigator.clipboard.writeText(text + " " + window.location.href).then(() => {
                   alert("Score copied to clipboard! Share it with your friends!");
               }).catch(() => {
                   alert("Share this: " + text + " " + window.location.href);
               });
           }
       }

       // Play sound effects
       function playSound(type) {
           // Create audio context for sound effects
           if (typeof AudioContext !== 'undefined' || typeof webkitAudioContext !== 'undefined') {
               const audioContext = new (AudioContext || webkitAudioContext)();
               
               const oscillator = audioContext.createOscillator();
               const gainNode = audioContext.createGain();
               
               oscillator.connect(gainNode);
               gainNode.connect(audioContext.destination);
               
               let frequency;
               let duration;
               
               switch(type) {
                   case 'correct':
                       frequency = 800;
                       duration = 0.2;
                       break;
                   case 'wrong':
                       frequency = 200;
                       duration = 0.5;
                       break;
                   case 'show':
                       frequency = 600;
                       duration = 0.3;
                       break;
                   default:
                       frequency = 440;
                       duration = 0.2;
               }
               
               oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
               gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
               gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
               
               oscillator.start(audioContext.currentTime);
               oscillator.stop(audioContext.currentTime + duration);
           }
       }

       // Utility Functions
       function showInstructions() {
           alert(`üß† Pattern Memory - How to Play

üéØ Objective:
Remember and repeat increasingly complex color patterns!

üïπÔ∏è How to Play:
1. Watch the sequence of colors light up
2. Click the tiles in the same order
3. Each level adds one more step to remember
4. Score points for each correct sequence
5. Game ends when you make a mistake

üèÜ Scoring:
- Points = Level √ó 10 per correct sequence
- Build streaks for bragging rights
- Beat your personal best!

üí° Tips:
- Focus and concentrate during the sequence
- Take your time - there's no rush
- Try to find patterns or create mental associations
- Practice makes perfect!

Good luck challenging your memory! üçÄ`);
       }

       function toggleFullscreen() {
           if (!document.fullscreenElement) {
               document.documentElement.requestFullscreen().catch(err => {
                   console.log("Fullscreen not supported");
               });
           } else {
               document.exitFullscreen();
           }
       }

       // Keyboard controls
       document.addEventListener('keydown', (e) => {
           if (!game.gameActive) return;
           
           const keyMap = {
               '1': 0, '2': 1, '3': 2,
               '4': 3, '5': 4, '6': 5,
               '7': 6, '8': 7, '9': 8
           };
           
           if (keyMap.hasOwnProperty(e.key)) {
               handleTileClick(keyMap[e.key]);
           }
           
           // Spacebar to start/restart
           if (e.code === 'Space') {
               e.preventDefault();
               if (!game.gameActive) {
                   startGame();
               }
           }
           
           // Escape to pause/menu
           if (e.code === 'Escape') {
               if (game.gameActive) {
                   if (confirm("Pause game and return to menu?")) {
                       resetGame();
                   }
               }
           }
       });

       // Touch controls for mobile
       let touchStartX = 0;
       let touchStartY = 0;

       document.addEventListener('touchstart', (e) => {
           touchStartX = e.touches[0].clientX;
           touchStartY = e.touches[0].clientY;
       });

       document.addEventListener('touchend', (e) => {
           if (!touchStartX || !touchStartY) return;
           
           const touchEndX = e.changedTouches[0].clientX;
           const touchEndY = e.changedTouches[0].clientY;
           
           const diffX = touchStartX - touchEndX;
           const diffY = touchStartY - touchEndY;
           
           // Reset values
           touchStartX = 0;
           touchStartY = 0;
       });

       // Initialize game when page loads
       document.addEventListener("DOMContentLoaded", () => {
           initGame();
       });

       // Prevent zoom on mobile
       let lastTouchEnd = 0;
       document.addEventListener("touchend", function (event) {
           const now = (new Date()).getTime();
           if (now - lastTouchEnd <= 300) {
               event.preventDefault();
           }
           lastTouchEnd = now;
       }, false);

       // Prevent context menu
       document.addEventListener("contextmenu", e => e.preventDefault());

       // Handle page visibility
       document.addEventListener("visibilitychange", () => {
           if (document.hidden && game.gameActive) {
               // Pause game when tab becomes inactive
               game.gameActive = false;
               document.getElementById("gameStatus").textContent = "Game paused - click to resume";
           }
       });

       // Add CSS animations for enhanced feedback
       const style = document.createElement('style');
       style.textContent = `
           @keyframes tilePress {
               0% { transform: scale(1); }
               50% { transform: scale(0.9); }
               100% { transform: scale(1); }
           }
           
           .pattern-tile:active {
               animation: tilePress 0.1s ease;
           }
           
           .new-high-score {
               animation: celebration 2s ease infinite;
           }
           
           @keyframes celebration {
               0%, 100% { 
                   transform: scale(1) rotate(0deg);
                   color: var(--accent-color);
               }
               25% { 
                   transform: scale(1.1) rotate(5deg);
                   color: var(--success-color);
               }
               75% { 
                   transform: scale(1.1) rotate(-5deg);
                   color: var(--warning-color);
               }
           }
           
           .loading {
               opacity: 0;
               animation: fadeIn 0.5s ease forwards;
           }
           
           @keyframes fadeIn {
               to { opacity: 1; }
           }
       `;
       document.head.appendChild(style);

       console.log("üß† Pattern Memory loaded successfully!");
   </script>
</body>
</html>