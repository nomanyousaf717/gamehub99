<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Connect - Free HTML5 Puzzle Game | GameHub 99</title>
    <meta name="description" content="Play Number Connect for free! Connect sequential numbers in this addictive puzzle game. Mobile-friendly browser game with no download required.">
    <meta name="keywords" content="number connect, puzzle game, html5 game, free online game, browser game, mobile game, number puzzle">
    <meta name="author" content="GameHub 99">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="game">
    <meta property="og:url" content="https://gamehub99.com/games/number-connect.html">
    <meta property="og:title" content="Number Connect - Free HTML5 Puzzle Game">
    <meta property="og:description" content="Connect sequential numbers in this addictive puzzle game!">
    <meta property="og:image" content="https://gamehub99.com/assets/number-connect-og.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://gamehub99.com/games/number-connect.html">
    <meta property="twitter:title" content="Number Connect - Free HTML5 Puzzle Game">
    <meta property="twitter:description" content="Connect sequential numbers in this addictive puzzle game!">
    <meta property="twitter:image" content="https://gamehub99.com/assets/number-connect-og.jpg">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark-gradient: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 100%);
            --accent-color: #00d4ff;
            --success-color: #00ff88;
            --warning-color: #ffaa00;
            --text-primary: #ffffff;
            --text-secondary: #b8c1ec;
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --shadow-glow: 0 0 40px rgba(0, 212, 255, 0.3);
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: "Inter", sans-serif;
            background: var(--dark-gradient);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .ad-container-top, .ad-container-bottom {
            width: 100%;
            min-height: 90px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--card-border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .ad-placeholder {
            width: 728px;
            height: 90px;
            background: linear-gradient(45deg, #333, #555);
            border: 2px dashed #666;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 14px;
            border-radius: 8px;
        }

        .header {
            padding: 1rem 0;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .game-title {
            font-family: "Orbitron", monospace;
            font-size: 2rem;
            font-weight: 900;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 10px 20px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 25px;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 0.9rem;
        }

        .nav-button:hover {
            background: var(--accent-color);
            color: #000;
            transform: translateY(-2px);
        }

        .game-container {
            flex: 1;
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            gap: 2rem;
            width: 100%;
        }

        .game-section {
            flex: 2;
            min-width: 320px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stats-section {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stat-box {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            padding: 0.8rem 1rem;
            text-align: center;
            backdrop-filter: blur(10px);
            min-width: 80px;
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-top: 0.2rem;
        }

        .game-controls {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .control-button {
            padding: 10px 16px;
            background: var(--primary-gradient);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .control-button.new-game {
            background: var(--success-color);
            color: #000;
        }

        .game-canvas-container {
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 15px;
            padding: 1rem;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-card);
            margin-bottom: 1rem;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            max-width: 400px;
            width: 100%;
        }

        .game-cell {
            aspect-ratio: 1;
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            color: var(--text-primary);
            min-height: 50px;
        }

        .game-cell:hover {
            background: var(--accent-color);
            color: #000;
            transform: scale(1.05);
        }

        .game-cell.selected {
            background: var(--success-color);
            color: #000;
            border-color: var(--success-color);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .game-cell.connected {
            background: var(--warning-color);
            color: #000;
            border-color: var(--warning-color);
        }

        .start-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .start-button {
            padding: 15px 30px;
            background: var(--primary-gradient);
            border: none;
            border-radius: 25px;
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow);
        }

        .mobile-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 200px;
            margin: 0 auto;
            padding: 1rem;
        }

        .mobile-control {
            aspect-ratio: 1;
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            min-height: 50px;
        }

        .mobile-control:hover {
            background: var(--accent-color);
            transform: scale(1.1);
        }

        .mobile-control.empty {
            visibility: hidden;
        }

        .sidebar {
            flex: 1;
            min-width: 280px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .info-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 15px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-card);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .instructions-list {
            list-style: none;
        }

        .instructions-list li {
            padding: 0.5rem 0;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .instructions-list li::before {
            content: "üéØ";
            font-size: 1rem;
        }

        .game-over-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: var(--dark-gradient);
            border: 2px solid var(--card-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: var(--shadow-card);
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 900;
            background: var(--secondary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .modal-stats {
            margin: 1.5rem 0;
        }

        .modal-stat {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--card-border);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .modal-button {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .modal-button.primary {
            background: var(--success-color);
            color: #000;
        }

        .modal-button.secondary {
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--card-border);
        }

        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        @media (max-width: 768px) {
            .ad-placeholder {
                width: 320px;
                height: 50px;
                font-size: 12px;
            }

            .game-container {
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
            }

            .game-title {
                font-size: 1.5rem;
            }

            .header-content {
                padding: 0 1rem;
            }

            .nav-buttons {
                justify-content: center;
            }

            .game-header {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }

            .stats-section {
                justify-content: center;
            }

            .game-controls {
                justify-content: center;
            }

            .mobile-controls {
                display: grid;
            }

            .game-board {
                grid-template-columns: repeat(5, 1fr);
                gap: 6px;
                padding: 15px;
            }

            .game-cell {
                font-size: 1rem;
                min-height: 40px;
            }
        }

        @media (max-width: 480px) {
            .game-board {
                grid-template-columns: repeat(4, 1fr);
                gap: 4px;
                padding: 10px;
            }

            .game-cell {
                font-size: 0.9rem;
                min-height: 35px;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .modal-buttons {
                flex-direction: column;
            }
        }

        .loading {
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 0.5s ease;
        }
    </style>
</head>
<body>
    <!-- Top Ad Container -->
    <div class="ad-container-top">
        <div class="ad-placeholder">728x90 Header Advertisement</div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="game-title">üî¢ Number Connect</h1>
            <nav class="nav-buttons">
                <a href="/" class="nav-button">üè† Home</a>
                <a href="/games" class="nav-button">üéÆ More Games</a>
                <a href="#" class="nav-button" onclick="showInstructions()">‚ùì How to Play</a>
                <a href="#" class="nav-button" onclick="toggleFullscreen()">üì± Fullscreen</a>
            </nav>
        </div>
    </header>

    <!-- Main Game Container -->
    <div class="game-container">
        <!-- Game Section -->
        <main class="game-section loading">
            <div class="game-header">
                <div class="stats-section">
                    <div class="stat-box">
                        <div class="stat-label">Score</div>
                        <div class="stat-value" id="currentScore">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Best</div>
                        <div class="stat-value" id="bestScore">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Moves</div>
                        <div class="stat-value" id="movesCount">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Level</div>
                        <div class="stat-value" id="gameLevel">1</div>
                    </div>
                </div>
                
                <div class="game-controls">
                    <button class="control-button new-game" onclick="newGame()">üÜï New Game</button>
                    <button class="control-button" onclick="shuffleBoard()">üîÑ Shuffle</button>
                    <button class="control-button" onclick="showLeaderboard()">üèÜ Scores</button>
                </div>
            </div>

            <!-- Game Board -->
            <div class="game-canvas-container">
                <div class="start-overlay" id="startOverlay">
                    <h2 style="color: var(--accent-color); margin-bottom: 1rem;">üî¢ Number Connect</h2>
                    <p style="color: var(--text-secondary); text-align: center; margin-bottom: 1rem;">
                        Connect sequential numbers to clear the board!<br>
                        Find pairs of consecutive numbers and click to connect them.
                    </p>
                    <button class="start-button" onclick="startGame()">üöÄ Start Game</button>
                </div>
                
                <div class="game-board" id="gameBoard">
                    <!-- Game cells will be generated here -->
                </div>
            </div>

            <!-- Mobile Controls -->
            <div class="mobile-controls" style="display: none;">
                <div class="mobile-control empty"></div>
                <div class="mobile-control" onclick="showHint()">üí°</div>
                <div class="mobile-control empty"></div>
            </div>
        </main>

        <!-- Sidebar -->
        <aside class="sidebar loading">
            <div class="info-card">
                <h3 class="card-title">üéØ How to Play</h3>
                <ul class="instructions-list">
                    <li>Find pairs of consecutive numbers (1-2, 3-4, etc.)</li>
                    <li>Click on both numbers to connect them</li>
                    <li>Connected pairs will disappear from the board</li>
                    <li>Clear all numbers to advance to the next level</li>
                    <li>Score points for each successful connection</li>
                    <li>Use shuffle button when stuck</li>
                </ul>
            </div>

            <div class="info-card">
                <h3 class="card-title">üèÜ Game Features</h3>
                <ul class="instructions-list">
                    <li>Progressive difficulty levels</li>
                    <li>Local high score tracking</li>
                    <li>Mobile-friendly touch controls</li>
                    <li>Addictive puzzle gameplay</li>
                    <li>Beautiful animations and effects</li>
                    <li>No time limits - play at your pace</li>
                </ul>
            </div>

            <div class="info-card">
                <h3 class="card-title">üéÆ More Games</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    Discover 99 amazing HTML5 games in our collection!
                </p>
                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                    <a href="/games/2048-deluxe.html" class="nav-button" style="font-size: 0.8rem;">2048 Deluxe</a>
                    <a href="/games/tetris-modern.html" class="nav-button" style="font-size: 0.8rem;">Tetris Modern</a>
                    <a href="/games/snake-evolution.html" class="nav-button" style="font-size: 0.8rem;">Snake Evolution</a>
                </div>
            </div>
        </aside>
    </div>

    <!-- Game Over Modal -->
    <div class="game-over-modal" id="gameOverModal">
        <div class="modal-content">
            <div class="modal-title">üéâ Level Complete!</div>
            <div class="modal-stats">
                <div class="modal-stat">
                    <span>Score:</span>
                    <span id="modalScore">0</span>
                </div>
                <div class="modal-stat">
                    <span>Level:</span>
                    <span id="modalLevel">1</span>
                </div>
                <div class="modal-stat">
                    <span>Moves:</span>
                    <span id="modalMoves">0</span>
                </div>
                <div class="modal-stat">
                    <span>Best Score:</span>
                    <span id="modalBest">0</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button primary" onclick="nextLevel()">üöÄ Next Level</button>
                <button class="modal-button secondary" onclick="newGame()">üÜï New Game</button>
                <button class="modal-button secondary" onclick="shareScore()">üì§ Share</button>
            </div>
        </div>
    </div>

    <!-- Bottom Ad Container -->
    <div class="ad-container-bottom">
        <div class="ad-placeholder">728x90 Footer Advertisement</div>
    </div>

    <script>
        // Game State
        const game = {
            board: [],
            gridSize: 6,
            score: 0,
            moves: 0,
            level: 1,
            bestScore: 0,
            gameStarted: false,
            selectedCells: [],
            numbers: [],
            maxNumber: 10
        };

        // Initialize Game
        function initGame() {
            // Load best score
            game.bestScore = parseInt(localStorage.getItem('numberConnect_bestScore') || '0');
            document.getElementById('bestScore').textContent = game.bestScore.toLocaleString();
            
            // Setup game board
            setupBoard();
            
            // Animate elements
            setTimeout(() => {
                document.querySelectorAll(".loading").forEach(el => {
                    el.style.opacity = "1";
                });
            }, 100);
        }

        // Setup Game Board
        function setupBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            // Adjust grid size based on level
            const gridSize = Math.min(6 + Math.floor(game.level / 3), 8);
            game.gridSize = gridSize;
            
            // Generate numbers for the board
            generateNumbers();
            
            // Create board cells
            board.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
            
            for (let i = 0; i < gridSize * gridSize; i++) {
                const cell = document.createElement('div');
                cell.className = 'game-cell';
                cell.dataset.index = i;
                cell.textContent = game.numbers[i] || '';
                cell.onclick = () => selectCell(i);
                
                if (!game.numbers[i]) {
                    cell.style.opacity = '0.3';
                    cell.style.pointerEvents = 'none';
                }
                
                board.appendChild(cell);
            }
        }

        // Generate Numbers for Board
        function generateNumbers() {
            const totalCells = game.gridSize * game.gridSize;
            const usableCells = Math.floor(totalCells * 0.8); // Use 80% of cells
            const pairCount = Math.floor(usableCells / 2);
            
            game.numbers = new Array(totalCells).fill(null);
            const positions = [];
            
            // Get random positions
            for (let i = 0; i < totalCells; i++) {
                positions.push(i);
            }
            positions.sort(() => Math.random() - 0.5);
            
            // Generate consecutive number pairs
            let usedPositions = 0;
            for (let i = 1; i <= pairCount && usedPositions < usableCells - 1; i++) {
                const baseNumber = Math.floor(Math.random() * game.maxNumber) + 1;
                
                // Place the pair
                game.numbers[positions[usedPositions]] = baseNumber;
                game.numbers[positions[usedPositions + 1]] = baseNumber + 1;
                
                usedPositions += 2;
            }
        }

        // Start Game
        function startGame() {
            document.getElementById('startOverlay').style.display = 'none';
            game.gameStarted = true;
            newGame();
            trackEvent('game_start');
        }

        // New Game
        function newGame() {
            game.score = 0;
            game.moves = 0;
            game.level = 1;
            game.gameStarted = true;
            game.selectedCells = [];
            game.maxNumber = 10;
            
            setupBoard();
            updateDisplay();
            closeModal();
            
            trackEvent('new_game');
        }

        // Select Cell
        function selectCell(index) {
            if (!game.gameStarted || !game.numbers[index]) return;
            
            const cell = document.querySelector(`[data-index="${index}"]`);
            
            // If cell is already selected, deselect it
            if (game.selectedCells.includes(index)) {
                game.selectedCells = game.selectedCells.filter(i => i !== index);
                cell.classList.remove('selected');
                return;
            }
            
            // Add to selection
            game.selectedCells.push(index);
            cell.classList.add('selected');
            
            // Check if we have two cells selected
            if (game.selectedCells.length === 2) {
                checkConnection();
            }
        }

        // Check Connection
        function checkConnection() {
            const [index1, index2] = game.selectedCells;
            const num1 = game.numbers[index1];
            const num2 = game.numbers[index2];
            
            // Check if numbers are consecutive
            if (Math.abs(num1 - num2) === 1) {
                // Valid connection
                connectNumbers(index1, index2);
                game.score += (num1 + num2) * 10;
                game.moves++;
                
                // Add bonus for level
                game.score += game.level * 50;
                
                trackEvent('valid_connection', num1 + '+' + num2);
            } else {
                // Invalid connection
                game.moves++;
                shakeAnimation();
                trackEvent('invalid_connection');
            }
            
            // Clear selection
            clearSelection();
            updateDisplay();
            
            // Check win condition
            setTimeout(checkWinCondition, 300);
        }

        // Connect Numbers
        function connectNumbers(index1, index2) {
            const cell1 = document.querySelector(`[data-index="${index1}"]`);
            const cell2 = document.querySelector(`[data-index="${index2}"]`);
            
            // Animate connection
            cell1.classList.add('connected');
            cell2.classList.add('connected');
            
            // Remove numbers after animation
            setTimeout(() => {
                game.numbers[index1] = null;
                game.numbers[index2] = null;
                cell1.style.opacity = '0.3';
                cell2.style.opacity = '0.3';
                cell1.style.pointerEvents = 'none';
                cell2.style.pointerEvents = 'none';
                cell1.textContent = '';
                cell2.textContent = '';
                cell1.classList.remove('connected');
                cell2.classList.remove('connected');
            }, 500);
        }

        // Clear Selection
       function clearSelection() {
           game.selectedCells.forEach(index => {
               const cell = document.querySelector(`[data-index="${index}"]`);
               cell.classList.remove('selected');
           });
           game.selectedCells = [];
       }

       // Check Win Condition
       function checkWinCondition() {
           const remainingNumbers = game.numbers.filter(num => num !== null);
           
           if (remainingNumbers.length === 0) {
               // Level complete
               levelComplete();
           } else if (!hasValidMoves()) {
               // No valid moves left
               gameOver();
           }
       }

       // Check if there are valid moves
       function hasValidMoves() {
           const activeNumbers = [];
           game.numbers.forEach((num, index) => {
               if (num !== null) {
                   activeNumbers.push(num);
               }
           });
           
           // Check if any consecutive pairs exist
           for (let i = 0; i < activeNumbers.length; i++) {
               for (let j = i + 1; j < activeNumbers.length; j++) {
                   if (Math.abs(activeNumbers[i] - activeNumbers[j]) === 1) {
                       return true;
                   }
               }
           }
           return false;
       }

       // Level Complete
       function levelComplete() {
           game.level++;
           game.maxNumber = Math.min(game.maxNumber + 2, 20); // Increase difficulty
           
           // Bonus points for completing level
           const levelBonus = game.level * 500;
           game.score += levelBonus;
           
           updateBestScore();
           updateDisplay();
           
           // Show completion modal
           showCompletionModal();
           
           trackEvent('level_complete', game.level.toString());
       }

       // Game Over
       function gameOver() {
           updateBestScore();
           
           // Show game over modal
           document.getElementById('gameOverModal').querySelector('.modal-title').textContent = 'üòî No More Moves!';
           showCompletionModal();
           
           trackEvent('game_over', game.score.toString());
       }

       // Show Completion Modal
       function showCompletionModal() {
           document.getElementById('modalScore').textContent = game.score.toLocaleString();
           document.getElementById('modalLevel').textContent = game.level;
           document.getElementById('modalMoves').textContent = game.moves;
           document.getElementById('modalBest').textContent = game.bestScore.toLocaleString();
           
           document.getElementById('gameOverModal').style.display = 'flex';
       }

       // Next Level
       function nextLevel() {
           closeModal();
           setupBoard();
           game.moves = 0;
           updateDisplay();
       }

       // Close Modal
       function closeModal() {
           document.getElementById('gameOverModal').style.display = 'none';
       }

       // Shuffle Board
       function shuffleBoard() {
           if (!game.gameStarted) return;
           
           // Get all non-null numbers
           const activeNumbers = game.numbers.filter(num => num !== null);
           
           if (activeNumbers.length === 0) return;
           
           // Shuffle the numbers
           for (let i = activeNumbers.length - 1; i > 0; i--) {
               const j = Math.floor(Math.random() * (i + 1));
               [activeNumbers[i], activeNumbers[j]] = [activeNumbers[j], activeNumbers[i]];
           }
           
           // Get available positions
           const availablePositions = [];
           game.numbers.forEach((num, index) => {
               if (num !== null) {
                   availablePositions.push(index);
               }
           });
           
           // Clear current numbers
           game.numbers.fill(null);
           
           // Place shuffled numbers
           activeNumbers.forEach((num, i) => {
               if (i < availablePositions.length) {
                   game.numbers[availablePositions[i]] = num;
               }
           });
           
           // Update board display
           setupBoard();
           game.moves++;
           updateDisplay();
           
           trackEvent('board_shuffle');
       }

       // Show Hint
       function showHint() {
           if (!game.gameStarted) return;
           
           // Find a valid pair
           const activeIndices = [];
           game.numbers.forEach((num, index) => {
               if (num !== null) {
                   activeIndices.push(index);
               }
           });
           
           for (let i = 0; i < activeIndices.length; i++) {
               for (let j = i + 1; j < activeIndices.length; j++) {
                   const index1 = activeIndices[i];
                   const index2 = activeIndices[j];
                   const num1 = game.numbers[index1];
                   const num2 = game.numbers[index2];
                   
                   if (Math.abs(num1 - num2) === 1) {
                       // Highlight the hint pair
                       const cell1 = document.querySelector(`[data-index="${index1}"]`);
                       const cell2 = document.querySelector(`[data-index="${index2}"]`);
                       
                       cell1.style.boxShadow = '0 0 20px var(--warning-color)';
                       cell2.style.boxShadow = '0 0 20px var(--warning-color)';
                       
                       setTimeout(() => {
                           cell1.style.boxShadow = '';
                           cell2.style.boxShadow = '';
                       }, 2000);
                       
                       // Deduct points for hint
                       game.score = Math.max(0, game.score - 100);
                       updateDisplay();
                       
                       trackEvent('hint_used');
                       return;
                   }
               }
           }
           
           alert('No hints available! Try shuffling the board.');
       }

       // Shake Animation
       function shakeAnimation() {
           const gameBoard = document.getElementById('gameBoard');
           gameBoard.style.animation = 'shake 0.5s ease-in-out';
           
           setTimeout(() => {
               gameBoard.style.animation = '';
           }, 500);
       }

       // Update Display
       function updateDisplay() {
           document.getElementById('currentScore').textContent = game.score.toLocaleString();
           document.getElementById('bestScore').textContent = game.bestScore.toLocaleString();
           document.getElementById('movesCount').textContent = game.moves;
           document.getElementById('gameLevel').textContent = game.level;
       }

       // Update Best Score
       function updateBestScore() {
           if (game.score > game.bestScore) {
               game.bestScore = game.score;
               localStorage.setItem('numberConnect_bestScore', game.bestScore.toString());
               
               // Celebration animation
               const bestScoreElement = document.getElementById('bestScore');
               bestScoreElement.classList.add('pulse');
               setTimeout(() => {
                   bestScoreElement.classList.remove('pulse');
               }, 1000);
           }
       }

       // Show Leaderboard
       function showLeaderboard() {
           const scores = JSON.parse(localStorage.getItem('numberConnect_scores') || '[]');
           let message = "üèÜ Number Connect - Top Scores üèÜ\n\n";
           
           if (scores.length === 0) {
               message += "No scores yet! Be the first!";
           } else {
               scores.slice(0, 5).forEach((score, index) => {
                   message += `#${index + 1}: ${score.toLocaleString()} pts\n`;
               });
           }
           
           alert(message);
       }

       // Save Score
       function saveScore() {
           if (game.score === 0) return;
           
           const scores = JSON.parse(localStorage.getItem('numberConnect_scores') || '[]');
           scores.push(game.score);
           scores.sort((a, b) => b - a);
           scores.splice(10); // Keep only top 10
           
           localStorage.setItem('numberConnect_scores', JSON.stringify(scores));
       }

       // Utility Functions
       function showInstructions() {
           alert(`üî¢ Number Connect - How to Play

üéØ Objective:
Connect pairs of consecutive numbers to clear the board!

üïπÔ∏è Controls:
- Click on two numbers to select them
- Numbers must be consecutive (1-2, 3-4, etc.)
- Connected pairs will disappear
- Clear all numbers to advance levels

üéÆ Gameplay:
- Score points for each connection
- Higher numbers = more points
- Complete levels for bonus points
- Use shuffle when stuck (costs points)
- Use hint for help (costs 100 points)

üèÜ Scoring:
- Connection: (Number1 + Number2) √ó 10
- Level bonus: Level √ó 50
- Completion bonus: Level √ó 500

Good luck connecting! üçÄ`);
       }

       function toggleFullscreen() {
           if (!document.fullscreenElement) {
               document.documentElement.requestFullscreen().catch(err => {
                   console.log("Fullscreen not supported");
               });
           } else {
               document.exitFullscreen();
           }
       }

       function shareScore() {
           const text = `üî¢ I just scored ${game.score.toLocaleString()} points in Number Connect! Can you beat my score? üèÜ`;
           
           if (navigator.share) {
               navigator.share({
                   title: "Number Connect - My Score",
                   text: text,
                   url: window.location.href
               });
           } else {
               navigator.clipboard.writeText(text + " " + window.location.href).then(() => {
                   alert("Score copied to clipboard! Share it with your friends!");
               }).catch(() => {
                   const shareText = text + "\n" + window.location.href;
                   prompt("Copy this text to share your score:", shareText);
               });
           }
           
           trackEvent('score_shared', game.score.toString());
       }

       // Analytics Tracking
       function trackEvent(eventName, eventValue = '') {
           // Google Analytics 4 tracking
           if (typeof gtag !== 'undefined') {
               gtag('event', eventName, {
                   'game_name': 'number_connect',
                   'value': eventValue,
                   'score': game.score,
                   'level': game.level
               });
           }
           
           console.log(`Event: ${eventName}`, eventValue);
       }

       // Keyboard Controls
       document.addEventListener('keydown', (event) => {
           switch (event.key) {
               case 'n':
               case 'N':
                   newGame();
                   break;
               case 's':
               case 'S':
                   shuffleBoard();
                   break;
               case 'h':
               case 'H':
                   showHint();
                   break;
               case 'Escape':
                   closeModal();
                   break;
               case ' ':
                   event.preventDefault();
                   if (document.getElementById('startOverlay').style.display !== 'none') {
                       startGame();
                   }
                   break;
           }
       });

       // Touch Controls for Mobile
       let touchStartX = 0;
       let touchStartY = 0;

       document.addEventListener('touchstart', (event) => {
           touchStartX = event.touches[0].clientX;
           touchStartY = event.touches[0].clientY;
       }, { passive: true });

       document.addEventListener('touchend', (event) => {
           if (!touchStartX || !touchStartY) return;
           
           const touchEndX = event.changedTouches[0].clientX;
           const touchEndY = event.changedTouches[0].clientY;
           
           const deltaX = touchStartX - touchEndX;
           const deltaY = touchStartY - touchEndY;
           
           // Reset values
           touchStartX = 0;
           touchStartY = 0;
       }, { passive: true });

       // Add shake animation CSS
       const style = document.createElement('style');
       style.textContent = `
           @keyframes shake {
               0%, 100% { transform: translateX(0); }
               25% { transform: translateX(-5px); }
               75% { transform: translateX(5px); }
           }
           
           @keyframes fadeInUp {
               from {
                   opacity: 0;
                   transform: translateY(30px);
               }
               to {
                   opacity: 1;
                   transform: translateY(0);
               }
           }
           
           .game-cell {
               animation: fadeInUp 0.3s ease forwards;
           }
           
           .game-cell:nth-child(odd) {
               animation-delay: 0.1s;
           }
           
           .game-cell:nth-child(even) {
               animation-delay: 0.2s;
           }
       `;
       document.head.appendChild(style);

       // Service Worker for PWA (optional)
       if ('serviceWorker' in navigator) {
           window.addEventListener('load', () => {
               navigator.serviceWorker.register('/sw.js').catch(() => {
                   console.log('Service Worker registration failed');
               });
           });
       }

       // Initialize game when page loads
       document.addEventListener('DOMContentLoaded', initGame);

       // Auto-save score on page unload
       window.addEventListener('beforeunload', () => {
           saveScore();
       });

       // Handle visibility change (pause when tab is hidden)
       document.addEventListener('visibilitychange', () => {
           if (document.hidden) {
               // Tab is hidden - could pause game here if needed
               console.log('Game paused - tab hidden');
           } else {
               // Tab is visible again
               console.log('Game resumed - tab visible');
           }
       });

       // Prevent zoom on mobile double-tap
       let lastTouchEnd = 0;
       document.addEventListener('touchend', (event) => {
           const now = (new Date()).getTime();
           if (now - lastTouchEnd <= 300) {
               event.preventDefault();
           }
           lastTouchEnd = now;
       }, false);

       // Handle orientation change
       window.addEventListener('orientationchange', () => {
           setTimeout(() => {
               // Recalculate layout after orientation change
               setupBoard();
           }, 100);
       });

       // Preload sounds (if you want to add audio)
       const sounds = {
           connect: new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEctmQ='), // Connection success
           error: new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjWh0TqmdDMhAUtmfzJHKAAAGm1'), // Error sound
           levelUp: new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcQMjr0dKfSCgAAAAAAAAA') // Level up
       };

       // Audio settings
       const audioEnabled = localStorage.getItem('numberConnect_audio') !== 'false';
       
       function playSound(soundName) {
           if (audioEnabled && sounds[soundName]) {
               sounds[soundName].currentTime = 0;
               sounds[soundName].play().catch(() => {
                   // Ignore audio play errors
               });
           }
       }

       // Add sound effects to game actions
       const originalConnectNumbers = connectNumbers;
       connectNumbers = function(index1, index2) {
           playSound('connect');
           return originalConnectNumbers(index1, index2);
       };

       const originalShakeAnimation = shakeAnimation;
       shakeAnimation = function() {
           playSound('error');
           return originalShakeAnimation();
       };

       const originalLevelComplete = levelComplete;
       levelComplete = function() {
           playSound('levelUp');
           return originalLevelComplete();
       };

       console.log('üî¢ Number Connect Game Loaded Successfully! üéÆ');
   </script>
</body>
</html>