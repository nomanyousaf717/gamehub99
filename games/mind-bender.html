<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mind Bender - Free HTML5 Puzzle Game | GamesZone99</title>
    <meta name="description" content="Play Mind Bender for free! Challenge your mind with this addictive logic puzzle game. Mobile-friendly browser game with no download required.">
    <meta name="keywords" content="mind-bender, logic puzzle, brain game, html5 game, free online game, browser game, mobile game, puzzle game">
    <meta name="author" content="GamesZone99">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="game">
    <meta property="og:url" content="https://gameszone99.com/mind-bender.html">
    <meta property="og:title" content="Mind Bender - Free HTML5 Puzzle Game">
    <meta property="og:description" content="Challenge your mind with this addictive logic puzzle game!">
    <meta property="og:image" content="https://gameszone99.com/assets/mind-bender-og.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://gameszone99.com/mind-bender.html">
    <meta property="twitter:title" content="Mind Bender - Free HTML5 Puzzle Game">
    <meta property="twitter:description" content="Challenge your mind with this addictive logic puzzle game!">
    <meta property="twitter:image" content="https://gameszone99.com/assets/mind-bender-og.jpg">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark-gradient: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 100%);
            --accent-color: #00d4ff;
            --success-color: #00ff88;
            --warning-color: #ffaa00;
            --danger-color: #ff4757;
            --text-primary: #ffffff;
            --text-secondary: #b8c1ec;
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --shadow-glow: 0 0 40px rgba(0, 212, 255, 0.3);
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: "Inter", sans-serif;
            background: var(--dark-gradient);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .ad-container-top, .ad-container-bottom {
            width: 100%;
            min-height: 90px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--card-border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .ad-placeholder {
            width: 728px;
            height: 90px;
            background: linear-gradient(45deg, #333, #555);
            border: 2px dashed #666;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 14px;
            border-radius: 8px;
        }

        .header {
            padding: 1.5rem 0;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
            text-align: center;
        }

        .header h1 {
            font-family: "Orbitron", monospace;
            font-size: 2.5rem;
            font-weight: 900;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            text-shadow: var(--shadow-glow);
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .main-container {
            display: flex;
            flex: 1;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .game-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-card);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-glow);
        }

        .stat-value {
            font-family: "Orbitron", monospace;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .game-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow-card);
            position: relative;
            overflow: hidden;
        }

        .game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(0, 212, 255, 0.1), transparent);
            pointer-events: none;
        }

        .game-area {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            max-width: 400px;
            margin: 0 auto 2rem;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid var(--card-border);
        }

        .puzzle-tile {
            aspect-ratio: 1;
            background: var(--primary-gradient);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .puzzle-tile:hover:not(.empty) {
            transform: scale(1.05);
            box-shadow: var(--shadow-glow);
        }

        .puzzle-tile.empty {
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed var(--card-border);
            cursor: default;
        }

        .puzzle-tile.highlight {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .game-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .btn {
            background: var(--primary-gradient);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-card);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .btn-start {
            background: var(--success-color);
            font-size: 1.2rem;
            padding: 15px 30px;
        }

        .btn-secondary {
            background: var(--secondary-gradient);
        }

        .btn-warning {
            background: var(--warning-color);
        }

        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 2rem;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        .mobile-control {
            aspect-ratio: 1;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        .mobile-control:hover {
            background: var(--primary-gradient);
            transform: scale(1.1);
        }

        .mobile-control.empty {
            visibility: hidden;
        }

        .sidebar {
            width: 300px;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .sidebar-section {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow-card);
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--accent-color);
        }

        .instructions ul {
            list-style: none;
            padding: 0;
        }

        .instructions li {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--card-border);
            color: var(--text-secondary);
        }

        .instructions li:last-child {
            border-bottom: none;
        }

        .game-over-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--dark-gradient);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: var(--shadow-glow);
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--success-color);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-stats {
            margin: 1.5rem 0;
            padding: 1rem;
            background: var(--card-bg);
            border-radius: 10px;
            border: 1px solid var(--card-border);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
            }

            .sidebar {
                width: 100%;
                order: -1;
            }

            .header h1 {
                font-size: 2rem;
            }

            .game-area {
                max-width: 100%;
                grid-template-columns: repeat(4, 1fr);
            }

            .mobile-controls {
                display: grid;
            }

            .ad-placeholder {
                width: 320px;
                height: 50px;
                font-size: 12px;
            }

            .ad-container-top, .ad-container-bottom {
                min-height: 60px;
            }
        }

        @media (max-width: 480px) {
            .game-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .puzzle-tile {
                font-size: 1.2rem;
            }

            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Top Ad Container -->
    <div class="ad-container-top">
        <div class="ad-placeholder">728x90 Header Advertisement</div>
    </div>

    <!-- Header -->
    <header class="header">
        <h1>🧠 Mind Bender</h1>
        <p>Challenge your mind with this addictive sliding puzzle game! Arrange numbers 1-15 in order.</p>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Game Section -->
        <main class="game-section">
            <!-- Game Stats -->
            <div class="game-stats">
                <div class="stat-card">
                    <div class="stat-value" id="currentScore">0</div>
                    <div class="stat-label">Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="bestScore">0</div>
                    <div class="stat-label">Best Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="movesCount">0</div>
                    <div class="stat-label">Moves</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="timeCount">00:00</div>
                    <div class="stat-label">Time</div>
                </div>
            </div>

            <!-- Game Container -->
            <div class="game-container">
                <div class="game-area" id="gameArea">
                    <!-- Puzzle tiles will be generated here -->
                </div>

                <!-- Game Controls -->
                <div class="game-controls">
                    <button class="btn btn-start" id="startBtn" onclick="startGame()">🎮 Start Game</button>
                    <button class="btn btn-secondary" onclick="shufflePuzzle()">🔄 Shuffle</button>
                    <button class="btn btn-warning" onclick="showHint()">💡 Hint</button>
                    <button class="btn" onclick="resetGame()">🆕 New Game</button>
                </div>

                <!-- Mobile Controls -->
                <div class="mobile-controls">
                    <div class="mobile-control empty"></div>
                    <div class="mobile-control" onclick="moveEmptyTile('up')">⬆️</div>
                    <div class="mobile-control empty"></div>
                    <div class="mobile-control" onclick="moveEmptyTile('left')">⬅️</div>
                    <div class="mobile-control" onclick="showInstructions()">❓</div>
                    <div class="mobile-control" onclick="moveEmptyTile('right')">➡️</div>
                    <div class="mobile-control empty"></div>
                    <div class="mobile-control" onclick="moveEmptyTile('down')">⬇️</div>
                    <div class="mobile-control empty"></div>
                </div>
            </div>
        </main>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-title">🎯 How to Play</h3>
                <div class="instructions">
                    <p><strong>Arrange numbers 1-15 in order!</strong></p>
                    <ul>
                        <li>🖱️ Click tiles to move them</li>
                        <li>⌨️ Use arrow keys to control</li>
                        <li>📱 Swipe on mobile devices</li>
                        <li>🎯 Solve with minimum moves</li>
                        <li>⏱️ Beat your best time</li>
                        <li>🏆 Challenge your friends</li>
                    </ul>
                </div>
            </div>

            <div class="sidebar-section" style="min-height: 250px; display: flex; align-items: center; justify-content: center;">
                <div style="width: 250px; height: 250px; background: linear-gradient(45deg, #333, #555); border: 2px dashed #666; display: flex; align-items: center; justify-content: center; color: #999; font-size: 14px; border-radius: 8px; text-align: center;">
                    250x250<br>Sidebar Ad
                </div>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-title">🏆 Leaderboard</h3>
                <div id="leaderboard">
                    <p style="color: var(--text-secondary); text-align: center;">Play to see high scores!</p>
                </div>
            </div>
        </aside>
    </div>

    <!-- Game Over Modal -->
    <div class="game-over-modal" id="gameOverModal">
        <div class="modal-content">
            <div class="modal-title">🎉 Puzzle Solved!</div>
            <div class="modal-stats">
                <p><strong>Final Score:</strong> <span id="finalScore">0</span></p>
                <p><strong>Moves:</strong> <span id="finalMoves">0</span></p>
                <p><strong>Time:</strong> <span id="finalTime">00:00</span></p>
                <p id="newRecord" style="color: var(--success-color); display: none;">🏆 New Best Score!</p>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-start" onclick="playAgain()">🎮 Play Again</button>
                <button class="btn btn-secondary" onclick="shareScore()">📱 Share</button>
                <button class="btn" onclick="closeModal()">❌ Close</button>
            </div>
        </div>
    </div>

    <!-- Bottom Ad Container -->
    <div class="ad-container-bottom">
        <div class="ad-placeholder">728x90 Footer Advertisement</div>
    </div>

    <script>
        // Game State
        const game = {
            board: [],
            emptyIndex: 15,
            moves: 0,
            score: 0,
            bestScore: localStorage.getItem("mindBenderBest") || 0,
            gameStarted: false,
            startTime: null,
            timer: null,
            solvedBoard: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0]
        };

        // Initialize game
        function initGame() {
            // Initialize solved board
            game.board = [...game.solvedBoard];
            
            // Load best score
            document.getElementById("bestScore").textContent = game.bestScore;
            
            // Create game board
            createGameBoard();
            
            // Add event listeners
            document.addEventListener('keydown', handleKeyPress);
            
            // Add touch support
            addTouchSupport();
            
            console.log("Mind Bender initialized!");
        }

        // Create game board
        function createGameBoard() {
            const gameArea = document.getElementById("gameArea");
            gameArea.innerHTML = "";
            
            for (let i = 0; i < 16; i++) {
                const tile = document.createElement("div");
                tile.className = "puzzle-tile";
                tile.dataset.index = i;
                
                if (game.board[i] === 0) {
                    tile.classList.add("empty");
                    tile.textContent = "";
                } else {
                    tile.textContent = game.board[i];
                    tile.onclick = () => moveTile(i);
                }
                
                gameArea.appendChild(tile);
            }
        }

        // Start game
        function startGame() {
            game.gameStarted = true;
            game.moves = 0;
            game.score = 0;
            game.startTime = Date.now();
            
            // Shuffle the puzzle
            shufflePuzzle();
            
            // Start timer
            startTimer();
            
            // Update UI
            document.getElementById("startBtn").textContent = "🎮 Game Running";
            document.getElementById("startBtn").disabled = true;
            updateStats();
            
            console.log("Game started!");
        }

        // Shuffle puzzle
        function shufflePuzzle() {
            // Start with solved state
            game.board = [...game.solvedBoard];
            game.emptyIndex = 15;
            
            // Perform random valid moves
            for (let i = 0; i < 1000; i++) {
                const possibleMoves = getPossibleMoves();
                const randomMove = possibleMoves[Math.floor(Math.random() * possibleMoves.length)];
                swapTiles(game.emptyIndex, randomMove);
                game.emptyIndex = randomMove;
            }
            
            // Reset moves counter after shuffling
            if (!game.gameStarted) {
                game.moves = 0;
            }
            
            createGameBoard();
            updateStats();
        }

        // Get possible moves for empty tile
        function getPossibleMoves() {
            const moves = [];
            const row = Math.floor(game.emptyIndex / 4);
            const col = game.emptyIndex % 4;
            
            // Up
            if (row > 0) moves.push(game.emptyIndex - 4);
            // Down
            if (row < 3) moves.push(game.emptyIndex + 4);
            // Left
            if (col > 0) moves.push(game.emptyIndex - 1);
            // Right
            if (col < 3) moves.push(game.emptyIndex + 1);
            
            return moves;
        }

        // Move tile
        function moveTile(index) {
            if (!game.gameStarted) {
                alert("Click 'Start Game' to begin!");
                return;
            }
            
            // Check if tile is adjacent to empty space
            const possibleMoves = getPossibleMoves();
            
            if (possibleMoves.includes(index)) {
                // Swap tiles
                swapTiles(index, game.emptyIndex);
                game.emptyIndex = index;
                game.moves++;
                
                // Update score
                game.score += 10;
                
                // Update display
                createGameBoard();
                updateStats();
                
                // Check for win
                checkWin();
            }
        }

        // Swap two tiles
        function swapTiles(index1, index2) {
            const temp = game.board[index1];
            game.board[index1] = game.board[index2];
            game.board[index2] = temp;
        }

        // Move empty tile (for mobile controls)
        function moveEmptyTile(direction) {
            if (!game.gameStarted) {
                alert("Click 'Start Game' to begin!");
                return;
            }
            
            const row = Math.floor(game.emptyIndex / 4);
            const col = game.emptyIndex % 4;
            let newIndex = game.emptyIndex;
            
            switch (direction) {
                case 'up':
                    if (row < 3) newIndex = game.emptyIndex + 4;
                    break;
                case 'down':
                    if (row > 0) newIndex = game.emptyIndex - 4;
                    break;
                case 'left':
                    if (col < 3) newIndex = game.emptyIndex + 1;
                    break;
                case 'right':
                    if (col > 0) newIndex = game.emptyIndex - 1;
                    break;
            }
            
            if (newIndex !== game.emptyIndex) {
                moveTile(newIndex);
            }
        }

        // Handle keyboard input
        function handleKeyPress(event) {
            if (!game.gameStarted) return;
            
            switch (event.key) {
                case 'ArrowUp':
                    event.preventDefault();
                    moveEmptyTile('up');
                    break;
                case 'ArrowDown':
                    event.preventDefault();
                    moveEmptyTile('down');
                    break;
                case 'ArrowLeft':
                    event.preventDefault();
                    moveEmptyTile('left');
                    break;
                case 'ArrowRight':
                    event.preventDefault();
                    moveEmptyTile('right');
                    break;
                case 'r':
                case 'R':
                    resetGame();
                    break;
                case 'h':
                case 'H':
                    showHint();
                    break;
            }
        }

        // Add touch support
        function addTouchSupport() {
            let startX, startY;
            const gameArea = document.getElementById("gameArea");
            
            gameArea.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            });
            
            gameArea.addEventListener('touchend', (e) => {
                if (!startX || !startY) return;
                
                const endX = e.changedTouches[0].clientX;
                const endY = e.changedTouches[0].clientY;
                
                const deltaX = endX - startX;
                const deltaY = endY - startY;
                
                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    // Horizontal swipe
                    if (deltaX > 30) {
                        moveEmptyTile('left');
                    } else if (deltaX < -30) {
                        moveEmptyTile('right');
                    }
                } else {
                    // Vertical swipe
                    if (deltaY > 30) {
                        moveEmptyTile('up');
                    } else if (deltaY < -30) {
                        moveEmptyTile('down');
                    }
                }
                
                startX = startY = null;
            });
        }

        // Check for win condition
        function checkWin() {
            const isSolved = game.board.every((val, index) => val === game.solvedBoard[index]);
            
            if (isSolved) {
                game.gameStarted = false;
                clearInterval(game.timer);
                
                // Calculate final score
                const timeBonus = Math.max(0, 1000 - Math.floor((Date.now() - game.startTime) / 1000));
                const moveBonus = Math.max(0, 500 - game.moves * 5);
                game.score += timeBonus + moveBonus;
                
                // Check for new best score
                let newRecord = false;
                if (game.score > game.bestScore) {
                    game.bestScore = game.score;
                    localStorage.setItem("mindBenderBest", game.bestScore);
                    newRecord = true;
                }
                
                // Show game over modal
                showGameOverModal(newRecord);
                
                // Update leaderboard
                updateLeaderboard();
            }
        }

        // Show game over modal
        function showGameOverModal(newRecord) {
            const modal = document.getElementById("gameOverModal");
            const finalTime = formatTime(Math.floor((Date.now() - game.startTime) / 1000));
            
            document.getElementById("finalScore").textContent = game.score.toLocaleString();
            document.getElementById("finalMoves").textContent = game.moves;
            document.getElementById("finalTime").textContent = finalTime;
            
            if (newRecord) {
                document.getElementById("newRecord").style.display = "block";
            } else {
                document.getElementById("newRecord").style.display = "none";
            }
            
            modal.style.display = "flex";
        }

        // Close modal
        function closeModal() {
            document.getElementById("gameOverModal").style.display = "none";
        }

       // Play again
       function playAgain() {
           closeModal();
           resetGame();
           startGame();
       }

       // Reset game
       function resetGame() {
           game.gameStarted = false;
           game.moves = 0;
           game.score = 0;
           game.startTime = null;
           clearInterval(game.timer);
           
           // Reset board to solved state
           game.board = [...game.solvedBoard];
           game.emptyIndex = 15;
           
           // Update UI
           document.getElementById("startBtn").textContent = "🎮 Start Game";
           document.getElementById("startBtn").disabled = false;
           document.getElementById("timeCount").textContent = "00:00";
           
           createGameBoard();
           updateStats();
       }

       // Start timer
       function startTimer() {
           game.timer = setInterval(() => {
               if (game.gameStarted) {
                   const elapsed = Math.floor((Date.now() - game.startTime) / 1000);
                   document.getElementById("timeCount").textContent = formatTime(elapsed);
               }
           }, 1000);
       }

       // Format time
       function formatTime(seconds) {
           const mins = Math.floor(seconds / 60);
           const secs = seconds % 60;
           return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
       }

       // Update stats display
       function updateStats() {
           document.getElementById("currentScore").textContent = game.score.toLocaleString();
           document.getElementById("bestScore").textContent = game.bestScore;
           document.getElementById("movesCount").textContent = game.moves;
       }

       // Show hint
       function showHint() {
           if (!game.gameStarted) {
               alert("Start the game first!");
               return;
           }
           
           // Find a tile that can move
           const possibleMoves = getPossibleMoves();
           if (possibleMoves.length > 0) {
               const hintIndex = possibleMoves[0];
               const tile = document.querySelector(`[data-index="${hintIndex}"]`);
               tile.classList.add("highlight");
               
               setTimeout(() => {
                   tile.classList.remove("highlight");
               }, 2000);
               
               // Small score penalty for hint
               game.score = Math.max(0, game.score - 5);
               updateStats();
           }
       }

       // Update leaderboard
       function updateLeaderboard() {
           let scores = JSON.parse(localStorage.getItem("mindBenderScores") || "[]");
           scores.push({
               score: game.score,
               moves: game.moves,
               time: Math.floor((Date.now() - game.startTime) / 1000),
               date: new Date().toLocaleDateString()
           });
           
           // Keep only top 5 scores
           scores.sort((a, b) => b.score - a.score);
           scores = scores.slice(0, 5);
           localStorage.setItem("mindBenderScores", JSON.stringify(scores));
           
           // Display leaderboard
           const leaderboard = document.getElementById("leaderboard");
           if (scores.length === 0) {
               leaderboard.innerHTML = '<p style="color: var(--text-secondary); text-align: center;">Play to see high scores!</p>';
           } else {
               leaderboard.innerHTML = scores.map((score, index) => 
                   `<div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--card-border);">
                       <span>#${index + 1}</span>
                       <span style="color: var(--accent-color);">${score.score.toLocaleString()}</span>
                   </div>`
               ).join('');
           }
       }

       // Share score
       function shareScore() {
           const text = `🧠 I just solved the Mind Bender puzzle in ${game.moves} moves with a score of ${game.score.toLocaleString()} points! Can you beat it? 🏆`;
           
           if (navigator.share) {
               navigator.share({
                   title: "Mind Bender - My Score",
                   text: text,
                   url: window.location.href
               }).catch(console.error);
           } else if (navigator.clipboard) {
               navigator.clipboard.writeText(text + " " + window.location.href).then(() => {
                   alert("Score copied to clipboard! Share it with your friends! 📱");
               }).catch(() => {
                   showShareDialog(text);
               });
           } else {
               showShareDialog(text);
           }
       }

       // Show share dialog
       function showShareDialog(text) {
           const shareText = text + "\n\nPlay at: " + window.location.href;
           prompt("Copy this text to share your score:", shareText);
       }

       // Show instructions
       function showInstructions() {
           alert(`🧠 Mind Bender - How to Play

🎯 Objective:
Arrange the numbers 1-15 in order, with the empty space in the bottom-right corner.

🕹️ Controls:
- Click tiles to move them into the empty space
- Use arrow keys to move the empty space
- Swipe on mobile devices
- Press 'H' for hints, 'R' to reset

🏆 Scoring:
- +10 points per move
- Time bonus for quick solving
- Move efficiency bonus
- -5 points for using hints

💡 Tips:
- Start by positioning the top row correctly
- Work row by row from top to bottom
- Use the hint system if you get stuck
- Try to solve with minimum moves for higher scores

Good luck! 🍀`);
       }

       // Add service worker for offline play
       if ('serviceWorker' in navigator) {
           navigator.serviceWorker.register('/sw.js').catch(() => {
               console.log('Service Worker registration failed');
           });
       }

       // Google Analytics (replace with your tracking ID)
       window.dataLayer = window.dataLayer || [];
       function gtag(){dataLayer.push(arguments);}
       gtag('js', new Date());
       gtag('config', 'GA_MEASUREMENT_ID');

       // Track game events
       function trackEvent(action, category = 'Mind Bender') {
           if (typeof gtag === 'function') {
               gtag('event', action, {
                   event_category: category,
                   event_label: 'HTML5 Game'
               });
           }
       }

       // Initialize game when page loads
       document.addEventListener('DOMContentLoaded', function() {
           initGame();
           updateLeaderboard();
           
           // Track page view
           trackEvent('game_loaded');
           
           // Add visibility change listener for pause functionality
           document.addEventListener('visibilitychange', function() {
               if (document.hidden && game.gameStarted) {
                   // Pause timer when tab is not visible
                   clearInterval(game.timer);
               } else if (!document.hidden && game.gameStarted && game.startTime) {
                   // Resume timer when tab becomes visible
                   startTimer();
               }
           });
       });

       // Prevent context menu on mobile
       document.addEventListener('contextmenu', function(e) {
           e.preventDefault();
       });

       // Prevent zoom on double tap
       let lastTouchEnd = 0;
       document.addEventListener('touchend', function(event) {
           const now = (new Date()).getTime();
           if (now - lastTouchEnd <= 300) {
               event.preventDefault();
           }
           lastTouchEnd = now;
       }, false);

       // Auto-save game state
       function saveGameState() {
           if (game.gameStarted) {
               const gameState = {
                   board: game.board,
                   emptyIndex: game.emptyIndex,
                   moves: game.moves,
                   score: game.score,
                   startTime: game.startTime
               };
               localStorage.setItem("mindBenderState", JSON.stringify(gameState));
           }
       }

       // Load game state
       function loadGameState() {
           const savedState = localStorage.getItem("mindBenderState");
           if (savedState) {
               try {
                   const state = JSON.parse(savedState);
                   if (confirm("Continue your previous game?")) {
                       game.board = state.board;
                       game.emptyIndex = state.emptyIndex;
                       game.moves = state.moves;
                       game.score = state.score;
                       game.startTime = state.startTime;
                       game.gameStarted = true;
                       
                       createGameBoard();
                       updateStats();
                       startTimer();
                       
                       document.getElementById("startBtn").textContent = "🎮 Game Running";
                       document.getElementById("startBtn").disabled = true;
                   }
                   localStorage.removeItem("mindBenderState");
               } catch (e) {
                   console.log("Could not load saved game state");
               }
           }
       }

       // Save game state periodically
       setInterval(saveGameState, 10000); // Save every 10 seconds

       // Save on page unload
       window.addEventListener('beforeunload', saveGameState);

       // Load saved state on page load
       window.addEventListener('load', loadGameState);
   </script>

   <!-- AdSense Script (replace with your AdSense code) -->
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXX" crossorigin="anonymous"></script>
   
   <!-- Google Analytics (replace with your tracking ID) -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
</body>
</html>